<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Vinu Kevin Diesel">

<title>Hw3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hm3-Kevin Diesel_files/libs/clipboard/clipboard.min.js"></script>
<script src="hm3-Kevin Diesel_files/libs/quarto-html/quarto.js"></script>
<script src="hm3-Kevin Diesel_files/libs/quarto-html/popper.min.js"></script>
<script src="hm3-Kevin Diesel_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hm3-Kevin Diesel_files/libs/quarto-html/anchor.min.js"></script>
<link href="hm3-Kevin Diesel_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hm3-Kevin Diesel_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hm3-Kevin Diesel_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hm3-Kevin Diesel_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hm3-Kevin Diesel_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Hw3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Vinu Kevin Diesel </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="classification-basic-concepts-and-techniques" class="level1">
<h1><strong>Classification: Basic Concepts and Techniques</strong></h1>
<section id="install-packages" class="level2">
<h2 class="anchored" data-anchor-id="install-packages"><strong>Install packages</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(pacman))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, rpart, rpart.plot, caret, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  lattice, FSelector, sampling, pROC, mlbench)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">The Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 1: tidytuesdayR package </span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="do">## install.packages("tidytuesdayR")</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#tuesdata &lt;- tidytuesdayR::tt_load('2023-08-15')</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="do">## OR</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#tuesdata &lt;- tidytuesdayR::tt_load(2023, week = 33)</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co">#spam &lt;- tuesdata$spam</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Option 2: Read directly from GitHub</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>spam <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">'https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2023/2023-08-15/spam.csv'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 4601 Columns: 7
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (1): yesno
dbl (6): crl.tot, dollar, bang, money, n000, make

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Converting all the nominal to factor, in this case there is none.</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>spam <span class="ot">&lt;-</span> spam <span class="sc">|&gt;</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.logical), factor)) <span class="sc">|&gt;</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), factor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="decision-trees" class="level2">
<h2 class="anchored" data-anchor-id="decision-trees"><strong>Decision Trees</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="create-tree-with-default-settings-uses-pre-pruning" class="level3">
<h3 class="anchored" data-anchor-id="create-tree-with-default-settings-uses-pre-pruning"><strong>Create Tree With Default Settings (uses pre-pruning)</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tree_default <span class="ot">&lt;-</span> spam <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpart</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make, <span class="at">data =</span> _)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Observation </span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Here we are, fitting a decision tree model where yesno is the target variable, and it's trying to predict it based on the values of the other specified variables (crl.tot, dollar, bang, money, n000, and make) using the rpart function. The resulting decision tree is stored in the tree_default variable.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plotting</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree_default, <span class="at">extra =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting the decision tree</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>from the above tree, using dollar, bang, crl.tot we arrive to the decisions. firstly, if the dollar feature’s value is greater than 0.056, then it is yes which means it is a spam. If not, it goes to the bang node and checks the value,if it is less than 0.092 it is a no which means it is not a spam. If not, it goes further to crl.tot node, where again it checks the crl.tot feature’s value. If it is not less than 86, it is yes else it goes to bang node and checks it value. If it is not less than, then it is yes, else it is no.</p>
</section>
<section id="create-a-full-tree" class="level3">
<h3 class="anchored" data-anchor-id="create-a-full-tree"><strong>Create a Full Tree</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tree_full <span class="ot">&lt;-</span> spam <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpart</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make, <span class="at">data =</span> _, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">minsplit =</span> <span class="dv">2</span>, <span class="at">cp =</span> <span class="dv">0</span>))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree_full, <span class="at">extra =</span> <span class="dv">2</span>, </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">roundint=</span><span class="cn">FALSE</span>,,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">box.palette =</span> <span class="fu">list</span>(<span class="st">"Gy"</span>, <span class="st">"Gn"</span>, <span class="st">"Bu"</span>, <span class="st">"Bn"</span>, </span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                               <span class="st">"Or"</span>, <span class="st">"Rd"</span>, <span class="st">"Pu"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: labs do not fit even at cex 0.15, there may be some overplotting</code></pre>
</div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above decision tree takes almost all features and gives a decision due to the complexity parameter cp being set to 0 and we set the minimum number of observations in a node needed to split to the smallest value of 2. This overfit the training data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tree_full</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>n= 4601 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

         1) root 4601 1813 n (0.605955227 0.394044773)  
           2) dollar&lt; 0.0555 3471  816 n (0.764909248 0.235090752)  
             4) bang&lt; 0.0915 2420  246 n (0.898347107 0.101652893)  
               8) n000&lt; 0.26 2399  232 n (0.903293039 0.096706961)  
                16) money&lt; 0.035 2351  213 n (0.909400255 0.090599745)  
                  32) crl.tot&lt; 29.5 809   31 n (0.961681088 0.038318912) *
                  33) crl.tot&gt;=29.5 1542  182 n (0.881971466 0.118028534)  
                    66) crl.tot&lt; 3241.5 1534  178 n (0.883963494 0.116036506)  
                     132) crl.tot&gt;=506.5 173    6 n (0.965317919 0.034682081)  
                       264) bang&lt; 0.0285 146    2 n (0.986301370 0.013698630)  
                         528) dollar&lt; 0.05 142    1 n (0.992957746 0.007042254)  
                          1056) crl.tot&lt; 1317 109    0 n (1.000000000 0.000000000) *
                          1057) crl.tot&gt;=1317 33    1 n (0.969696970 0.030303030)  
                            2114) crl.tot&gt;=1324 32    0 n (1.000000000 0.000000000) *
                            2115) crl.tot&lt; 1324 1    0 y (0.000000000 1.000000000) *
                         529) dollar&gt;=0.05 4    1 n (0.750000000 0.250000000) *
                       265) bang&gt;=0.0285 27    4 n (0.851851852 0.148148148)  
                         530) bang&gt;=0.0345 20    1 n (0.950000000 0.050000000)  
                          1060) crl.tot&lt; 980.5 14    0 n (1.000000000 0.000000000) *
                          1061) crl.tot&gt;=980.5 6    1 n (0.833333333 0.166666667)  
                            2122) crl.tot&gt;=1008 5    0 n (1.000000000 0.000000000) *
                            2123) crl.tot&lt; 1008 1    0 y (0.000000000 1.000000000) *
                         531) bang&lt; 0.0345 7    3 n (0.571428571 0.428571429)  
                          1062) make&gt;=0.07 3    0 n (1.000000000 0.000000000) *
                          1063) make&lt; 0.07 4    1 y (0.250000000 0.750000000)  
                            2126) crl.tot&gt;=2756.5 1    0 n (1.000000000 0.000000000) *
                            2127) crl.tot&lt; 2756.5 3    0 y (0.000000000 1.000000000) *
                     133) crl.tot&lt; 506.5 1361  172 n (0.873622337 0.126377663)  
                       266) dollar&lt; 0.039 1331  161 n (0.879038317 0.120961683)  
                         532) crl.tot&lt; 502 1325  158 n (0.880754717 0.119245283)  
                          1064) crl.tot&lt; 98.5 698   68 n (0.902578797 0.097421203)  
                            2128) make&lt; 2.215 696   67 n (0.903735632 0.096264368)  
                              4256) make&gt;=0.58 44    0 n (1.000000000 0.000000000) *
                              4257) make&lt; 0.58 652   67 n (0.897239264 0.102760736)  
                                8514) make&lt; 0.5 646   65 n (0.899380805 0.100619195)  
                                 17028) crl.tot&gt;=88.5 66    2 n (0.969696970 0.030303030) *
                                 17029) crl.tot&lt; 88.5 580   63 n (0.891379310 0.108620690)  
                                   34058) crl.tot&gt;=36.5 479   48 n (0.899791232 0.100208768)  
                                     68116) crl.tot&lt; 48.5 160   11 n (0.931250000 0.068750000) *
                                     68117) crl.tot&gt;=48.5 319   37 n (0.884012539 0.115987461)  
                                      136234) bang&lt; 0.058 304   33 n (0.891447368 0.108552632)  
                                        272468) crl.tot&gt;=51.5 273   27 n (0.901098901 0.098901099)  
                                          544936) crl.tot&lt; 60.5 74    4 n (0.945945946 0.054054054) *
                                          544937) crl.tot&gt;=60.5 199   23 n (0.884422111 0.115577889)  
                                           1089874) crl.tot&gt;=62.5 180   18 n (0.900000000 0.100000000)  
                                             2179748) crl.tot&lt; 65.5 24    0 n (1.000000000 0.000000000) *
                                             2179749) crl.tot&gt;=65.5 156   18 n (0.884615385 0.115384615)  
                                               4359498) crl.tot&gt;=66.5 152   16 n (0.894736842 0.105263158)  
                                                 8718996) make&lt; 0.32 144   14 n (0.902777778 0.097222222) *
                                                 8718997) make&gt;=0.32 8    2 n (0.750000000 0.250000000)  
                                                  17437994) crl.tot&gt;=70 6    0 n (1.000000000 0.000000000) *
                                                  17437995) crl.tot&lt; 70 2    0 y (0.000000000 1.000000000) *
                                               4359499) crl.tot&lt; 66.5 4    2 n (0.500000000 0.500000000) *
                                           1089875) crl.tot&lt; 62.5 19    5 n (0.736842105 0.263157895) *
                                        272469) crl.tot&lt; 51.5 31    6 n (0.806451613 0.193548387) *
                                      136235) bang&gt;=0.058 15    4 n (0.733333333 0.266666667)  
                                        272470) bang&gt;=0.0805 6    0 n (1.000000000 0.000000000) *
                                        272471) bang&lt; 0.0805 9    4 n (0.555555556 0.444444444)  
                                          544942) crl.tot&gt;=68 7    2 n (0.714285714 0.285714286)  
                                           1089884) bang&lt; 0.0765 4    0 n (1.000000000 0.000000000) *
                                           1089885) bang&gt;=0.0765 3    1 y (0.333333333 0.666666667)  
                                             2179770) crl.tot&gt;=76 2    1 n (0.500000000 0.500000000)  
                                               4359540) crl.tot&lt; 80 1    0 n (1.000000000 0.000000000) *
                                               4359541) crl.tot&gt;=80 1    0 y (0.000000000 1.000000000) *
                                             2179771) crl.tot&lt; 76 1    0 y (0.000000000 1.000000000) *
                                          544943) crl.tot&lt; 68 2    0 y (0.000000000 1.000000000) *
                                   34059) crl.tot&lt; 36.5 101   15 n (0.851485149 0.148514851) *
                                8515) make&gt;=0.5 6    2 n (0.666666667 0.333333333)  
                                 17030) crl.tot&lt; 78 4    0 n (1.000000000 0.000000000) *
                                 17031) crl.tot&gt;=78 2    0 y (0.000000000 1.000000000) *
                            2129) make&gt;=2.215 2    1 n (0.500000000 0.500000000)  
                              4258) crl.tot&lt; 40 1    0 n (1.000000000 0.000000000) *
                              4259) crl.tot&gt;=40 1    0 y (0.000000000 1.000000000) *
                          1065) crl.tot&gt;=98.5 627   90 n (0.856459330 0.143540670)  
                            2130) bang&lt; 0.0875 624   88 n (0.858974359 0.141025641)  
                              4260) crl.tot&gt;=186.5 272   29 n (0.893382353 0.106617647)  
                                8520) crl.tot&lt; 207.5 50    0 n (1.000000000 0.000000000) *
                                8521) crl.tot&gt;=207.5 222   29 n (0.869369369 0.130630631)  
                                 17042) crl.tot&gt;=208.5 219   27 n (0.876712329 0.123287671)  
                                   34084) n000&lt; 0.135 215   25 n (0.883720930 0.116279070)  
                                     68168) make&gt;=0.035 48    2 n (0.958333333 0.041666667)  
                                      136336) make&lt; 0.405 43    1 n (0.976744186 0.023255814)  
                                        272672) crl.tot&lt; 411 31    0 n (1.000000000 0.000000000) *
                                        272673) crl.tot&gt;=411 12    1 n (0.916666667 0.083333333)  
                                          545346) crl.tot&gt;=416 11    0 n (1.000000000 0.000000000) *
                                          545347) crl.tot&lt; 416 1    0 y (0.000000000 1.000000000) *
                                      136337) make&gt;=0.405 5    1 n (0.800000000 0.200000000)  
                                        272674) make&gt;=0.42 4    0 n (1.000000000 0.000000000) *
                                        272675) make&lt; 0.42 1    0 y (0.000000000 1.000000000) *
                                     68169) make&lt; 0.035 167   23 n (0.862275449 0.137724551)  
                                      136338) crl.tot&lt; 480.5 160   20 n (0.875000000 0.125000000)  
                                        272676) dollar&lt; 0.0315 158   19 n (0.879746835 0.120253165)  
                                          545352) bang&gt;=0.0375 28    1 n (0.964285714 0.035714286)  
                                           1090704) crl.tot&lt; 427 27    0 n (1.000000000 0.000000000) *
                                           1090705) crl.tot&gt;=427 1    0 y (0.000000000 1.000000000) *
                                          545353) bang&lt; 0.0375 130   18 n (0.861538462 0.138461538)  
                                           1090706) bang&lt; 0.032 126   14 n (0.888888889 0.111111111)  
                                             2181412) crl.tot&gt;=249.5 97    8 n (0.917525773 0.082474227)  
                                               4362824) crl.tot&lt; 358.5 51    2 n (0.960784314 0.039215686)  
                                                 8725648) crl.tot&gt;=292.5 30    0 n (1.000000000 0.000000000) *
                                                 8725649) crl.tot&lt; 292.5 21    2 n (0.904761905 0.095238095)  
                                                  17451298) crl.tot&lt; 291 20    1 n (0.950000000 0.050000000)  
                                                    34902596) crl.tot&gt;=266 11    0 n (1.000000000 0.000000000) *
                                                    34902597) crl.tot&lt; 266 9    1 n (0.888888889 0.111111111)  
                                                      69805194) crl.tot&lt; 263.5 8    0 n (1.000000000 0.000000000) *
                                                      69805195) crl.tot&gt;=263.5 1    0 y (0.000000000 1.000000000) *
                                                  17451299) crl.tot&gt;=291 1    0 y (0.000000000 1.000000000) *
                                               4362825) crl.tot&gt;=358.5 46    6 n (0.869565217 0.130434783)  
                                                 8725650) crl.tot&gt;=365.5 43    4 n (0.906976744 0.093023256)  
                                                  17451300) crl.tot&lt; 378.5 13    0 n (1.000000000 0.000000000) *
                                                  17451301) crl.tot&gt;=378.5 30    4 n (0.866666667 0.133333333)  
                                                    34902602) crl.tot&gt;=379.5 29    3 n (0.896551724 0.103448276)  
                                                      69805204) crl.tot&lt; 399 9    0 n (1.000000000 0.000000000) *
                                                      69805205) crl.tot&gt;=399 20    3 n (0.850000000 0.150000000)  
                                                       139610410) crl.tot&gt;=405.5 19    2 n (0.894736842 0.105263158)  
                                                         279220820) crl.tot&lt; 424.5 5    0 n (1.000000000 0.000000000) *
                                                         279220821) crl.tot&gt;=424.5 14    2 n (0.857142857 0.142857143)  
                                                           558441642) crl.tot&gt;=426.5 13    1 n (0.923076923 0.076923077) *
                                                           558441643) crl.tot&lt; 426.5 1    0 y (0.000000000 1.000000000) *
                                                       139610411) crl.tot&lt; 405.5 1    0 y (0.000000000 1.000000000) *
                                                    34902603) crl.tot&lt; 379.5 1    0 y (0.000000000 1.000000000) *
                                                 8725651) crl.tot&lt; 365.5 3    1 y (0.333333333 0.666666667)  
                                                  17451302) dollar&gt;=0.012 1    0 n (1.000000000 0.000000000) *
                                                  17451303) dollar&lt; 0.012 2    0 y (0.000000000 1.000000000) *
                                             2181413) crl.tot&lt; 249.5 29    6 n (0.793103448 0.206896552)  
                                               4362826) crl.tot&lt; 239.5 25    3 n (0.880000000 0.120000000)  
                                                 8725652) crl.tot&gt;=235 9    0 n (1.000000000 0.000000000) *
                                                 8725653) crl.tot&lt; 235 16    3 n (0.812500000 0.187500000)  
                                                  17451306) crl.tot&lt; 233 15    2 n (0.866666667 0.133333333)  
                                                    34902612) crl.tot&lt; 227.5 12    1 n (0.916666667 0.083333333) *
                                                    34902613) crl.tot&gt;=227.5 3    1 n (0.666666667 0.333333333)  
                                                      69805226) crl.tot&gt;=229 2    0 n (1.000000000 0.000000000) *
                                                      69805227) crl.tot&lt; 229 1    0 y (0.000000000 1.000000000) *
                                                  17451307) crl.tot&gt;=233 1    0 y (0.000000000 1.000000000) *
                                               4362827) crl.tot&gt;=239.5 4    1 y (0.250000000 0.750000000)  
                                                 8725654) crl.tot&gt;=244.5 2    1 n (0.500000000 0.500000000)  
                                                  17451308) crl.tot&lt; 248.5 1    0 n (1.000000000 0.000000000) *
                                                  17451309) crl.tot&gt;=248.5 1    0 y (0.000000000 1.000000000) *
                                                 8725655) crl.tot&lt; 244.5 2    0 y (0.000000000 1.000000000) *
                                           1090707) bang&gt;=0.032 4    0 y (0.000000000 1.000000000) *
                                        272677) dollar&gt;=0.0315 2    1 n (0.500000000 0.500000000)  
                                          545354) crl.tot&gt;=273.5 1    0 n (1.000000000 0.000000000) *
                                          545355) crl.tot&lt; 273.5 1    0 y (0.000000000 1.000000000) *
                                      136339) crl.tot&gt;=480.5 7    3 n (0.571428571 0.428571429)  
                                        272678) crl.tot&gt;=494 3    0 n (1.000000000 0.000000000) *
                                        272679) crl.tot&lt; 494 4    1 y (0.250000000 0.750000000)  
                                          545358) crl.tot&gt;=483.5 2    1 n (0.500000000 0.500000000)  
                                           1090716) crl.tot&lt; 488.5 1    0 n (1.000000000 0.000000000) *
                                           1090717) crl.tot&gt;=488.5 1    0 y (0.000000000 1.000000000) *
                                          545359) crl.tot&lt; 483.5 2    0 y (0.000000000 1.000000000) *
                                   34085) n000&gt;=0.135 4    2 n (0.500000000 0.500000000)  
                                     68170) dollar&lt; 0.0195 2    0 n (1.000000000 0.000000000) *
                                     68171) dollar&gt;=0.0195 2    0 y (0.000000000 1.000000000) *
                                 17043) crl.tot&lt; 208.5 3    1 y (0.333333333 0.666666667)  
                                   34086) bang&gt;=0.0595 1    0 n (1.000000000 0.000000000) *
                                   34087) bang&lt; 0.0595 2    0 y (0.000000000 1.000000000) *
                              4261) crl.tot&lt; 186.5 352   59 n (0.832386364 0.167613636)  
                                8522) crl.tot&lt; 185.5 348   57 n (0.836206897 0.163793103)  
                                 17044) make&gt;=0.315 29    1 n (0.965517241 0.034482759)  
                                   34088) bang&lt; 0.045 21    0 n (1.000000000 0.000000000) *
                                   34089) bang&gt;=0.045 8    1 n (0.875000000 0.125000000)  
                                     68178) bang&gt;=0.047 7    0 n (1.000000000 0.000000000) *
                                     68179) bang&lt; 0.047 1    0 y (0.000000000 1.000000000) *
                                 17045) make&lt; 0.315 319   56 n (0.824451411 0.175548589)  
                                   34090) make&lt; 0.305 318   55 n (0.827044025 0.172955975)  
                                     68180) dollar&lt; 0.0095 313   53 n (0.830670927 0.169329073)  
                                      136360) make&lt; 0.265 308   51 n (0.834415584 0.165584416)  
                                        272720) make&gt;=0.06 13    0 n (1.000000000 0.000000000) *
                                        272721) make&lt; 0.06 295   51 n (0.827118644 0.172881356)  
                                          545442) crl.tot&gt;=172.5 24    2 n (0.916666667 0.083333333) *
                                          545443) crl.tot&lt; 172.5 271   49 n (0.819188192 0.180811808)  
                                           1090886) crl.tot&lt; 170 266   47 n (0.823308271 0.176691729)  
                                             2181772) crl.tot&gt;=106.5 228   38 n (0.833333333 0.166666667)  
                                               4363544) bang&gt;=0.0535 11    0 n (1.000000000 0.000000000) *
                                               4363545) bang&lt; 0.0535 217   38 n (0.824884793 0.175115207)  
                                                 8727090) bang&lt; 0.0495 215   36 n (0.832558140 0.167441860)  
                                                  17454180) crl.tot&gt;=166.5 8    0 n (1.000000000 0.000000000) *
                                                  17454181) crl.tot&lt; 166.5 207   36 n (0.826086957 0.173913043)  
                                                    34908362) bang&lt; 0.043 202   34 n (0.831683168 0.168316832)  
                                                      69816724) crl.tot&lt; 165 200   33 n (0.835000000 0.165000000)  
                                                       139633448) crl.tot&gt;=162.5 5    0 n (1.000000000 0.000000000) *
                                                       139633449) crl.tot&lt; 162.5 195   33 n (0.830769231 0.169230769)  
                                                         279266898) crl.tot&lt; 161.5 191   31 n (0.837696335 0.162303665)  
                                                           558533796) crl.tot&gt;=145.5 40    4 n (0.900000000 0.100000000) *
                                                           558533797) crl.tot&lt; 145.5 151   27 n (0.821192053 0.178807947)  
                                                            1117067594) crl.tot&lt; 143.5 144   23 n (0.840277778 0.159722222) *
                                                            1117067595) crl.tot&gt;=143.5 7    3 y (0.428571429 0.571428571) *
                                                         279266899) crl.tot&gt;=161.5 4    2 n (0.500000000 0.500000000) *
                                                      69816725) crl.tot&gt;=165 2    1 n (0.500000000 0.500000000) *
                                                    34908363) bang&gt;=0.043 5    2 n (0.600000000 0.400000000)  
                                                      69816726) bang&gt;=0.0465 3    0 n (1.000000000 0.000000000) *
                                                      69816727) bang&lt; 0.0465 2    0 y (0.000000000 1.000000000) *
                                                 8727091) bang&gt;=0.0495 2    0 y (0.000000000 1.000000000) *
                                             2181773) crl.tot&lt; 106.5 38    9 n (0.763157895 0.236842105)  
                                               4363546) crl.tot&lt; 105.5 30    5 n (0.833333333 0.166666667)  
                                                 8727092) bang&lt; 0.0755 29    4 n (0.862068966 0.137931034)  
                                                  17454184) crl.tot&gt;=102.5 14    1 n (0.928571429 0.071428571) *
                                                  17454185) crl.tot&lt; 102.5 15    3 n (0.800000000 0.200000000)  
                                                    34908370) crl.tot&lt; 101.5 14    2 n (0.857142857 0.142857143) *
                                                    34908371) crl.tot&gt;=101.5 1    0 y (0.000000000 1.000000000) *
                                                 8727093) bang&gt;=0.0755 1    0 y (0.000000000 1.000000000) *
                                               4363547) crl.tot&gt;=105.5 8    4 n (0.500000000 0.500000000)  
                                                 8727094) bang&gt;=0.0195 2    0 n (1.000000000 0.000000000) *
                                                 8727095) bang&lt; 0.0195 6    2 y (0.333333333 0.666666667) *
                                           1090887) crl.tot&gt;=170 5    2 n (0.600000000 0.400000000)  
                                             2181774) bang&gt;=0.0775 1    0 n (1.000000000 0.000000000) *
                                             2181775) bang&lt; 0.0775 4    2 n (0.500000000 0.500000000)  
                                               4363550) bang&lt; 0.0385 3    1 n (0.666666667 0.333333333) *
                                               4363551) bang&gt;=0.0385 1    0 y (0.000000000 1.000000000) *
                                      136361) make&gt;=0.265 5    2 n (0.600000000 0.400000000)  
                                        272722) make&gt;=0.295 2    0 n (1.000000000 0.000000000) *
                                        272723) make&lt; 0.295 3    1 y (0.333333333 0.666666667)  
                                          545446) bang&gt;=0.04 1    0 n (1.000000000 0.000000000) *
                                          545447) bang&lt; 0.04 2    0 y (0.000000000 1.000000000) *
                                     68181) dollar&gt;=0.0095 5    2 n (0.600000000 0.400000000)  
                                      136362) crl.tot&lt; 169.5 3    0 n (1.000000000 0.000000000) *
                                      136363) crl.tot&gt;=169.5 2    0 y (0.000000000 1.000000000) *
                                   34091) make&gt;=0.305 1    0 y (0.000000000 1.000000000) *
                                8523) crl.tot&gt;=185.5 4    2 n (0.500000000 0.500000000)  
                                 17046) make&lt; 0.355 3    1 n (0.666666667 0.333333333) *
                                 17047) make&gt;=0.355 1    0 y (0.000000000 1.000000000) *
                            2131) bang&gt;=0.0875 3    1 y (0.333333333 0.666666667)  
                              4262) crl.tot&gt;=176 1    0 n (1.000000000 0.000000000) *
                              4263) crl.tot&lt; 176 2    0 y (0.000000000 1.000000000) *
                         533) crl.tot&gt;=502 6    3 n (0.500000000 0.500000000)  
                          1066) dollar&gt;=0.0155 2    0 n (1.000000000 0.000000000) *
                          1067) dollar&lt; 0.0155 4    1 y (0.250000000 0.750000000)  
                            2134) crl.tot&gt;=505.5 2    1 n (0.500000000 0.500000000)  
                              4268) bang&lt; 0.0165 1    0 n (1.000000000 0.000000000) *
                              4269) bang&gt;=0.0165 1    0 y (0.000000000 1.000000000) *
                            2135) crl.tot&lt; 505.5 2    0 y (0.000000000 1.000000000) *
                       267) dollar&gt;=0.039 30   11 n (0.633333333 0.366666667)  
                         534) make&lt; 0.11 25    6 n (0.760000000 0.240000000)  
                          1068) crl.tot&lt; 478.5 23    4 n (0.826086957 0.173913043)  
                            2136) n000&lt; 0.18 22    3 n (0.863636364 0.136363636)  
                              4272) dollar&gt;=0.049 7    0 n (1.000000000 0.000000000) *
                              4273) dollar&lt; 0.049 15    3 n (0.800000000 0.200000000)  
                                8546) crl.tot&gt;=166 9    1 n (0.888888889 0.111111111)  
                                 17092) crl.tot&lt; 410.5 6    0 n (1.000000000 0.000000000) *
                                 17093) crl.tot&gt;=410.5 3    1 n (0.666666667 0.333333333)  
                                   34186) crl.tot&gt;=419.5 2    0 n (1.000000000 0.000000000) *
                                   34187) crl.tot&lt; 419.5 1    0 y (0.000000000 1.000000000) *
                                8547) crl.tot&lt; 166 6    2 n (0.666666667 0.333333333)  
                                 17094) crl.tot&lt; 159.5 5    1 n (0.800000000 0.200000000) *
                                 17095) crl.tot&gt;=159.5 1    0 y (0.000000000 1.000000000) *
                            2137) n000&gt;=0.18 1    0 y (0.000000000 1.000000000) *
                          1069) crl.tot&gt;=478.5 2    0 y (0.000000000 1.000000000) *
                         535) make&gt;=0.11 5    0 y (0.000000000 1.000000000) *
                    67) crl.tot&gt;=3241.5 8    4 n (0.500000000 0.500000000)  
                     134) crl.tot&gt;=3326 6    2 n (0.666666667 0.333333333)  
                       268) make&lt; 0.07 4    0 n (1.000000000 0.000000000) *
                       269) make&gt;=0.07 2    0 y (0.000000000 1.000000000) *
                     135) crl.tot&lt; 3326 2    0 y (0.000000000 1.000000000) *
                17) money&gt;=0.035 48   19 n (0.604166667 0.395833333)  
                  34) bang&lt; 0.08 45   16 n (0.644444444 0.355555556)  
                    68) crl.tot&lt; 1061 40   12 n (0.700000000 0.300000000)  
                     136) money&lt; 1.335 26    4 n (0.846153846 0.153846154)  
                       272) bang&lt; 0.0585 19    1 n (0.947368421 0.052631579)  
                         544) money&gt;=0.075 16    0 n (1.000000000 0.000000000) *
                         545) money&lt; 0.075 3    1 n (0.666666667 0.333333333)  
                          1090) crl.tot&gt;=420 2    0 n (1.000000000 0.000000000) *
                          1091) crl.tot&lt; 420 1    0 y (0.000000000 1.000000000) *
                       273) bang&gt;=0.0585 7    3 n (0.571428571 0.428571429)  
                         546) crl.tot&gt;=373 3    0 n (1.000000000 0.000000000) *
                         547) crl.tot&lt; 373 4    1 y (0.250000000 0.750000000)  
                          1094) bang&gt;=0.072 1    0 n (1.000000000 0.000000000) *
                          1095) bang&lt; 0.072 3    0 y (0.000000000 1.000000000) *
                     137) money&gt;=1.335 14    6 y (0.428571429 0.571428571)  
                       274) crl.tot&lt; 54.5 8    2 n (0.750000000 0.250000000)  
                         548) crl.tot&gt;=4.5 7    1 n (0.857142857 0.142857143)  
                          1096) money&gt;=1.535 6    0 n (1.000000000 0.000000000) *
                          1097) money&lt; 1.535 1    0 y (0.000000000 1.000000000) *
                         549) crl.tot&lt; 4.5 1    0 y (0.000000000 1.000000000) *
                       275) crl.tot&gt;=54.5 6    0 y (0.000000000 1.000000000) *
                    69) crl.tot&gt;=1061 5    1 y (0.200000000 0.800000000)  
                     138) make&gt;=0.08 1    0 n (1.000000000 0.000000000) *
                     139) make&lt; 0.08 4    0 y (0.000000000 1.000000000) *
                  35) bang&gt;=0.08 3    0 y (0.000000000 1.000000000) *
               9) n000&gt;=0.26 21    7 y (0.333333333 0.666666667)  
                18) n000&gt;=0.665 4    0 n (1.000000000 0.000000000) *
                19) n000&lt; 0.665 17    3 y (0.176470588 0.823529412)  
                  38) dollar&gt;=0.024 3    1 n (0.666666667 0.333333333)  
                    76) crl.tot&gt;=293 2    0 n (1.000000000 0.000000000) *
                    77) crl.tot&lt; 293 1    0 y (0.000000000 1.000000000) *
                  39) dollar&lt; 0.024 14    1 y (0.071428571 0.928571429)  
                    78) make&gt;=0.345 1    0 n (1.000000000 0.000000000) *
                    79) make&lt; 0.345 13    0 y (0.000000000 1.000000000) *
             5) bang&gt;=0.0915 1051  481 y (0.457659372 0.542340628)  
              10) crl.tot&lt; 85.5 535  175 n (0.672897196 0.327102804)  
                20) bang&lt; 0.7735 418  106 n (0.746411483 0.253588517)  
                  40) money&lt; 0.835 408   97 n (0.762254902 0.237745098)  
                    80) crl.tot&lt; 51.5 255   40 n (0.843137255 0.156862745)  
                     160) n000&lt; 0.64 254   39 n (0.846456693 0.153543307)  
                       320) crl.tot&lt; 12.5 13    0 n (1.000000000 0.000000000) *
                       321) crl.tot&gt;=12.5 241   39 n (0.838174274 0.161825726)  
                         642) bang&lt; 0.191 64    6 n (0.906250000 0.093750000)  
                          1284) bang&gt;=0.1135 52    3 n (0.942307692 0.057692308)  
                            2568) bang&gt;=0.1645 22    0 n (1.000000000 0.000000000) *
                            2569) bang&lt; 0.1645 30    3 n (0.900000000 0.100000000)  
                              5138) bang&lt; 0.1455 17    0 n (1.000000000 0.000000000) *
                              5139) bang&gt;=0.1455 13    3 n (0.769230769 0.230769231)  
                               10278) bang&gt;=0.148 10    1 n (0.900000000 0.100000000)  
                                 20556) bang&lt; 0.1625 8    0 n (1.000000000 0.000000000) *
                                 20557) bang&gt;=0.1625 2    1 n (0.500000000 0.500000000)  
                                   41114) crl.tot&lt; 37 1    0 n (1.000000000 0.000000000) *
                                   41115) crl.tot&gt;=37 1    0 y (0.000000000 1.000000000) *
                               10279) bang&lt; 0.148 3    1 y (0.333333333 0.666666667)  
                                 20558) crl.tot&gt;=22.5 2    1 n (0.500000000 0.500000000)  
                                   41116) crl.tot&lt; 29.5 1    0 n (1.000000000 0.000000000) *
                                   41117) crl.tot&gt;=29.5 1    0 y (0.000000000 1.000000000) *
                                 20559) crl.tot&lt; 22.5 1    0 y (0.000000000 1.000000000) *
                          1285) bang&lt; 0.1135 12    3 n (0.750000000 0.250000000)  
                            2570) bang&lt; 0.1085 7    0 n (1.000000000 0.000000000) *
                            2571) bang&gt;=0.1085 5    2 y (0.400000000 0.600000000)  
                              5142) crl.tot&gt;=29 4    2 n (0.500000000 0.500000000)  
                               10284) crl.tot&lt; 47.5 3    1 n (0.666666667 0.333333333)  
                                 20568) crl.tot&gt;=38.5 1    0 n (1.000000000 0.000000000) *
                                 20569) crl.tot&lt; 38.5 2    1 n (0.500000000 0.500000000)  
                                   41138) make&gt;=0.28 1    0 n (1.000000000 0.000000000) *
                                   41139) make&lt; 0.28 1    0 y (0.000000000 1.000000000) *
                               10285) crl.tot&gt;=47.5 1    0 y (0.000000000 1.000000000) *
                              5143) crl.tot&lt; 29 1    0 y (0.000000000 1.000000000) *
                         643) bang&gt;=0.191 177   33 n (0.813559322 0.186440678)  
                          1286) bang&gt;=0.2035 169   29 n (0.828402367 0.171597633)  
                            2572) bang&lt; 0.2625 31    2 n (0.935483871 0.064516129)  
                              5144) crl.tot&gt;=26 26    1 n (0.961538462 0.038461538)  
                               10288) crl.tot&lt; 47.5 21    0 n (1.000000000 0.000000000) *
                               10289) crl.tot&gt;=47.5 5    1 n (0.800000000 0.200000000)  
                                 20578) crl.tot&gt;=48.5 4    0 n (1.000000000 0.000000000) *
                                 20579) crl.tot&lt; 48.5 1    0 y (0.000000000 1.000000000) *
                              5145) crl.tot&lt; 26 5    1 n (0.800000000 0.200000000)  
                               10290) crl.tot&lt; 24.5 4    0 n (1.000000000 0.000000000) *
                               10291) crl.tot&gt;=24.5 1    0 y (0.000000000 1.000000000) *
                            2573) bang&gt;=0.2625 138   27 n (0.804347826 0.195652174)  
                              5146) make&lt; 1.745 137   26 n (0.810218978 0.189781022)  
                               10292) bang&gt;=0.329 112   19 n (0.830357143 0.169642857)  
                                 20584) crl.tot&lt; 48.5 111   18 n (0.837837838 0.162162162)  
                                   41168) bang&lt; 0.6145 79   10 n (0.873417722 0.126582278)  
                                     82336) bang&gt;=0.549 10    0 n (1.000000000 0.000000000) *
                                     82337) bang&lt; 0.549 69   10 n (0.855072464 0.144927536)  
                                      164674) bang&lt; 0.5335 65    8 n (0.876923077 0.123076923)  
                                        329348) bang&lt; 0.3505 9    0 n (1.000000000 0.000000000) *
                                        329349) bang&gt;=0.3505 56    8 n (0.857142857 0.142857143)  
                                          658698) bang&gt;=0.3525 55    7 n (0.872727273 0.127272727)  
                                           1317396) crl.tot&gt;=26.5 36    3 n (0.916666667 0.083333333)  
                                             2634792) bang&gt;=0.4175 22    0 n (1.000000000 0.000000000) *
                                             2634793) bang&lt; 0.4175 14    3 n (0.785714286 0.214285714)  
                                               5269586) bang&lt; 0.4145 13    2 n (0.846153846 0.153846154)  
                                                10539172) crl.tot&lt; 45.5 11    1 n (0.909090909 0.090909091)  
                                                  21078344) crl.tot&lt; 29.5 5    0 n (1.000000000 0.000000000) *
                                                  21078345) crl.tot&gt;=29.5 6    1 n (0.833333333 0.166666667)  
                                                    42156690) crl.tot&gt;=31.5 5    0 n (1.000000000 0.000000000) *
                                                    42156691) crl.tot&lt; 31.5 1    0 y (0.000000000 1.000000000) *
                                                10539173) crl.tot&gt;=45.5 2    1 n (0.500000000 0.500000000)  
                                                  21078346) bang&gt;=0.3925 1    0 n (1.000000000 0.000000000) *
                                                  21078347) bang&lt; 0.3925 1    0 y (0.000000000 1.000000000) *
                                               5269587) bang&gt;=0.4145 1    0 y (0.000000000 1.000000000) *
                                           1317397) crl.tot&lt; 26.5 19    4 n (0.789473684 0.210526316)  
                                             2634794) bang&lt; 0.452 12    1 n (0.916666667 0.083333333)  
                                               5269588) crl.tot&lt; 25 10    0 n (1.000000000 0.000000000) *
                                               5269589) crl.tot&gt;=25 2    1 n (0.500000000 0.500000000)  
                                                10539178) bang&gt;=0.397 1    0 n (1.000000000 0.000000000) *
                                                10539179) bang&lt; 0.397 1    0 y (0.000000000 1.000000000) *
                                             2634795) bang&gt;=0.452 7    3 n (0.571428571 0.428571429)  
                                               5269590) bang&gt;=0.471 5    1 n (0.800000000 0.200000000)  
                                                10539180) crl.tot&gt;=18 4    0 n (1.000000000 0.000000000) *
                                                10539181) crl.tot&lt; 18 1    0 y (0.000000000 1.000000000) *
                                               5269591) bang&lt; 0.471 2    0 y (0.000000000 1.000000000) *
                                          658699) bang&lt; 0.3525 1    0 y (0.000000000 1.000000000) *
                                      164675) bang&gt;=0.5335 4    2 n (0.500000000 0.500000000)  
                                        329350) crl.tot&lt; 15 1    0 n (1.000000000 0.000000000) *
                                        329351) crl.tot&gt;=15 3    1 y (0.333333333 0.666666667)  
                                          658702) crl.tot&lt; 19.5 2    1 n (0.500000000 0.500000000)  
                                           1317404) bang&gt;=0.545 1    0 n (1.000000000 0.000000000) *
                                           1317405) bang&lt; 0.545 1    0 y (0.000000000 1.000000000) *
                                          658703) crl.tot&gt;=19.5 1    0 y (0.000000000 1.000000000) *
                                   41169) bang&gt;=0.6145 32    8 n (0.750000000 0.250000000)  
                                     82338) crl.tot&lt; 27 25    3 n (0.880000000 0.120000000)  
                                      164676) bang&gt;=0.618 24    2 n (0.916666667 0.083333333)  
                                        329352) crl.tot&gt;=14 20    1 n (0.950000000 0.050000000)  
                                          658704) crl.tot&lt; 22.5 15    0 n (1.000000000 0.000000000) *
                                          658705) crl.tot&gt;=22.5 5    1 n (0.800000000 0.200000000)  
                                           1317410) bang&lt; 0.719 3    0 n (1.000000000 0.000000000) *
                                           1317411) bang&gt;=0.719 2    1 n (0.500000000 0.500000000)  
                                             2634822) crl.tot&gt;=24.5 1    0 n (1.000000000 0.000000000) *
                                             2634823) crl.tot&lt; 24.5 1    0 y (0.000000000 1.000000000) *
                                        329353) crl.tot&lt; 14 4    1 n (0.750000000 0.250000000)  
                                          658706) bang&gt;=0.7275 2    0 n (1.000000000 0.000000000) *
                                          658707) bang&lt; 0.7275 2    1 n (0.500000000 0.500000000)  
                                           1317414) bang&lt; 0.702 1    0 n (1.000000000 0.000000000) *
                                           1317415) bang&gt;=0.702 1    0 y (0.000000000 1.000000000) *
                                      164677) bang&lt; 0.618 1    0 y (0.000000000 1.000000000) *
                                     82339) crl.tot&gt;=27 7    2 y (0.285714286 0.714285714)  
                                      164678) crl.tot&gt;=40.5 1    0 n (1.000000000 0.000000000) *
                                      164679) crl.tot&lt; 40.5 6    1 y (0.166666667 0.833333333)  
                                        329358) bang&lt; 0.69 3    1 y (0.333333333 0.666666667)  
                                          658716) bang&gt;=0.6775 1    0 n (1.000000000 0.000000000) *
                                          658717) bang&lt; 0.6775 2    0 y (0.000000000 1.000000000) *
                                        329359) bang&gt;=0.69 3    0 y (0.000000000 1.000000000) *
                                 20585) crl.tot&gt;=48.5 1    0 y (0.000000000 1.000000000) *
                               10293) bang&lt; 0.329 25    7 n (0.720000000 0.280000000)  
                                 20586) crl.tot&gt;=21.5 20    4 n (0.800000000 0.200000000)  
                                   41172) bang&lt; 0.288 10    0 n (1.000000000 0.000000000) *
                                   41173) bang&gt;=0.288 10    4 n (0.600000000 0.400000000)  
                                     82346) bang&gt;=0.3115 6    1 n (0.833333333 0.166666667)  
                                      164692) crl.tot&gt;=46.5 3    0 n (1.000000000 0.000000000) *
                                      164693) crl.tot&lt; 46.5 3    1 n (0.666666667 0.333333333)  
                                        329386) crl.tot&lt; 36.5 2    0 n (1.000000000 0.000000000) *
                                        329387) crl.tot&gt;=36.5 1    0 y (0.000000000 1.000000000) *
                                     82347) bang&lt; 0.3115 4    1 y (0.250000000 0.750000000)  
                                      164694) crl.tot&lt; 38.5 2    1 n (0.500000000 0.500000000)  
                                        329388) crl.tot&gt;=33 1    0 n (1.000000000 0.000000000) *
                                        329389) crl.tot&lt; 33 1    0 y (0.000000000 1.000000000) *
                                      164695) crl.tot&gt;=38.5 2    0 y (0.000000000 1.000000000) *
                                 20587) crl.tot&lt; 21.5 5    2 y (0.400000000 0.600000000)  
                                   41174) crl.tot&lt; 15 2    0 n (1.000000000 0.000000000) *
                                   41175) crl.tot&gt;=15 3    0 y (0.000000000 1.000000000) *
                              5147) make&gt;=1.745 1    0 y (0.000000000 1.000000000) *
                          1287) bang&lt; 0.2035 8    4 n (0.500000000 0.500000000)  
                            2574) crl.tot&lt; 28 2    0 n (1.000000000 0.000000000) *
                            2575) crl.tot&gt;=28 6    2 y (0.333333333 0.666666667)  
                              5150) crl.tot&lt; 44 4    2 n (0.500000000 0.500000000)  
                               10300) crl.tot&gt;=36.5 3    1 n (0.666666667 0.333333333)  
                                 20600) crl.tot&gt;=41.5 1    0 n (1.000000000 0.000000000) *
                                 20601) crl.tot&lt; 41.5 2    1 n (0.500000000 0.500000000)  
                                   41202) bang&gt;=0.2025 1    0 n (1.000000000 0.000000000) *
                                   41203) bang&lt; 0.2025 1    0 y (0.000000000 1.000000000) *
                               10301) crl.tot&lt; 36.5 1    0 y (0.000000000 1.000000000) *
                              5151) crl.tot&gt;=44 2    0 y (0.000000000 1.000000000) *
                     161) n000&gt;=0.64 1    0 y (0.000000000 1.000000000) *
                    81) crl.tot&gt;=51.5 153   57 n (0.627450980 0.372549020)  
                     162) bang&lt; 0.4065 115   31 n (0.730434783 0.269565217)  
                       324) bang&lt; 0.171 40    5 n (0.875000000 0.125000000)  
                         648) bang&gt;=0.1325 18    0 n (1.000000000 0.000000000) *
                         649) bang&lt; 0.1325 22    5 n (0.772727273 0.227272727)  
                          1298) crl.tot&gt;=62 19    3 n (0.842105263 0.157894737)  
                            2596) bang&lt; 0.13 18    2 n (0.888888889 0.111111111)  
                              5192) make&lt; 0.525 17    1 n (0.941176471 0.058823529)  
                               10384) crl.tot&gt;=68.5 13    0 n (1.000000000 0.000000000) *
                               10385) crl.tot&lt; 68.5 4    1 n (0.750000000 0.250000000)  
                                 20770) bang&lt; 0.117 3    0 n (1.000000000 0.000000000) *
                                 20771) bang&gt;=0.117 1    0 y (0.000000000 1.000000000) *
                              5193) make&gt;=0.525 1    0 y (0.000000000 1.000000000) *
                            2597) bang&gt;=0.13 1    0 y (0.000000000 1.000000000) *
                          1299) crl.tot&lt; 62 3    1 y (0.333333333 0.666666667)  
                            2598) bang&gt;=0.109 1    0 n (1.000000000 0.000000000) *
                            2599) bang&lt; 0.109 2    0 y (0.000000000 1.000000000) *
                       325) bang&gt;=0.171 75   26 n (0.653333333 0.346666667)  
                         650) bang&gt;=0.1755 72   23 n (0.680555556 0.319444444)  
                          1300) crl.tot&lt; 80.5 65   18 n (0.723076923 0.276923077)  
                            2600) crl.tot&gt;=54.5 55   12 n (0.781818182 0.218181818)  
                              5200) make&lt; 1.51 54   11 n (0.796296296 0.203703704)  
                               10400) make&gt;=0.27 8    0 n (1.000000000 0.000000000) *
                               10401) make&lt; 0.27 46   11 n (0.760869565 0.239130435)  
                                 20802) bang&gt;=0.1945 43    9 n (0.790697674 0.209302326)  
                                   41604) crl.tot&lt; 68.5 24    3 n (0.875000000 0.125000000)  
                                     83208) crl.tot&gt;=60 15    0 n (1.000000000 0.000000000) *
                                     83209) crl.tot&lt; 60 9    3 n (0.666666667 0.333333333)  
                                      166418) crl.tot&lt; 57.5 6    1 n (0.833333333 0.166666667)  
                                        332836) bang&lt; 0.2975 3    0 n (1.000000000 0.000000000) *
                                        332837) bang&gt;=0.2975 3    1 n (0.666666667 0.333333333)  
                                          665674) bang&gt;=0.3165 2    0 n (1.000000000 0.000000000) *
                                          665675) bang&lt; 0.3165 1    0 y (0.000000000 1.000000000) *
                                      166419) crl.tot&gt;=57.5 3    1 y (0.333333333 0.666666667)  
                                        332838) bang&lt; 0.274 1    0 n (1.000000000 0.000000000) *
                                        332839) bang&gt;=0.274 2    0 y (0.000000000 1.000000000) *
                                   41605) crl.tot&gt;=68.5 19    6 n (0.684210526 0.315789474)  
                                     83210) crl.tot&gt;=75.5 13    3 n (0.769230769 0.230769231)  
                                      166420) bang&gt;=0.2585 8    1 n (0.875000000 0.125000000)  
                                        332840) bang&lt; 0.35 5    0 n (1.000000000 0.000000000) *
                                        332841) bang&gt;=0.35 3    1 n (0.666666667 0.333333333)  
                                          665682) bang&gt;=0.3685 2    0 n (1.000000000 0.000000000) *
                                          665683) bang&lt; 0.3685 1    0 y (0.000000000 1.000000000) *
                                      166421) bang&lt; 0.2585 5    2 n (0.600000000 0.400000000)  
                                        332842) bang&lt; 0.2125 2    0 n (1.000000000 0.000000000) *
                                        332843) bang&gt;=0.2125 3    1 y (0.333333333 0.666666667)  
                                          665686) crl.tot&gt;=77.5 2    1 n (0.500000000 0.500000000)  
                                           1331372) crl.tot&lt; 78.5 1    0 n (1.000000000 0.000000000) *
                                           1331373) crl.tot&gt;=78.5 1    0 y (0.000000000 1.000000000) *
                                          665687) crl.tot&lt; 77.5 1    0 y (0.000000000 1.000000000) *
                                     83211) crl.tot&lt; 75.5 6    3 n (0.500000000 0.500000000)  
                                      166422) bang&lt; 0.272 4    1 n (0.750000000 0.250000000)  
                                        332844) crl.tot&lt; 70.5 2    0 n (1.000000000 0.000000000) *
                                        332845) crl.tot&gt;=70.5 2    1 n (0.500000000 0.500000000)  
                                          665690) crl.tot&gt;=71.5 1    0 n (1.000000000 0.000000000) *
                                          665691) crl.tot&lt; 71.5 1    0 y (0.000000000 1.000000000) *
                                      166423) bang&gt;=0.272 2    0 y (0.000000000 1.000000000) *
                                 20803) bang&lt; 0.1945 3    1 y (0.333333333 0.666666667)  
                                   41606) crl.tot&lt; 56.5 1    0 n (1.000000000 0.000000000) *
                                   41607) crl.tot&gt;=56.5 2    0 y (0.000000000 1.000000000) *
                              5201) make&gt;=1.51 1    0 y (0.000000000 1.000000000) *
                            2601) crl.tot&lt; 54.5 10    4 y (0.400000000 0.600000000)  
                              5202) bang&gt;=0.2435 7    3 n (0.571428571 0.428571429)  
                               10404) bang&lt; 0.2865 2    0 n (1.000000000 0.000000000) *
                               10405) bang&gt;=0.2865 5    2 y (0.400000000 0.600000000)  
                                 20810) crl.tot&gt;=53.5 1    0 n (1.000000000 0.000000000) *
                                 20811) crl.tot&lt; 53.5 4    1 y (0.250000000 0.750000000)  
                                   41622) crl.tot&lt; 52.5 2    1 n (0.500000000 0.500000000)  
                                     83244) bang&gt;=0.3205 1    0 n (1.000000000 0.000000000) *
                                     83245) bang&lt; 0.3205 1    0 y (0.000000000 1.000000000) *
                                   41623) crl.tot&gt;=52.5 2    0 y (0.000000000 1.000000000) *
                              5203) bang&lt; 0.2435 3    0 y (0.000000000 1.000000000) *
                          1301) crl.tot&gt;=80.5 7    2 y (0.285714286 0.714285714)  
                            2602) crl.tot&gt;=82.5 3    1 n (0.666666667 0.333333333)  
                              5204) bang&gt;=0.2355 2    0 n (1.000000000 0.000000000) *
                              5205) bang&lt; 0.2355 1    0 y (0.000000000 1.000000000) *
                            2603) crl.tot&lt; 82.5 4    0 y (0.000000000 1.000000000) *
                         651) bang&lt; 0.1755 3    0 y (0.000000000 1.000000000) *
                     163) bang&gt;=0.4065 38   12 y (0.315789474 0.684210526)  
                       326) crl.tot&lt; 67.5 18    9 n (0.500000000 0.500000000)  
                         652) bang&lt; 0.448 4    1 n (0.750000000 0.250000000)  
                          1304) crl.tot&lt; 55 2    0 n (1.000000000 0.000000000) *
                          1305) crl.tot&gt;=55 2    1 n (0.500000000 0.500000000)  
                            2610) crl.tot&gt;=58 1    0 n (1.000000000 0.000000000) *
                            2611) crl.tot&lt; 58 1    0 y (0.000000000 1.000000000) *
                         653) bang&gt;=0.448 14    6 y (0.428571429 0.571428571)  
                          1306) bang&gt;=0.5785 4    1 n (0.750000000 0.250000000)  
                            2612) crl.tot&gt;=58 3    0 n (1.000000000 0.000000000) *
                            2613) crl.tot&lt; 58 1    0 y (0.000000000 1.000000000) *
                          1307) bang&lt; 0.5785 10    3 y (0.300000000 0.700000000)  
                            2614) bang&gt;=0.4705 8    3 y (0.375000000 0.625000000)  
                              5228) crl.tot&lt; 57 1    0 n (1.000000000 0.000000000) *
                              5229) crl.tot&gt;=57 7    2 y (0.285714286 0.714285714)  
                               10458) bang&lt; 0.485 1    0 n (1.000000000 0.000000000) *
                               10459) bang&gt;=0.485 6    1 y (0.166666667 0.833333333)  
                                 20918) crl.tot&lt; 63.5 3    1 y (0.333333333 0.666666667)  
                                   41836) crl.tot&gt;=62 1    0 n (1.000000000 0.000000000) *
                                   41837) crl.tot&lt; 62 2    0 y (0.000000000 1.000000000) *
                                 20919) crl.tot&gt;=63.5 3    0 y (0.000000000 1.000000000) *
                            2615) bang&lt; 0.4705 2    0 y (0.000000000 1.000000000) *
                       327) crl.tot&gt;=67.5 20    3 y (0.150000000 0.850000000)  
                         654) crl.tot&gt;=81 1    0 n (1.000000000 0.000000000) *
                         655) crl.tot&lt; 81 19    2 y (0.105263158 0.894736842)  
                          1310) crl.tot&gt;=71.5 12    2 y (0.166666667 0.833333333)  
                            2620) crl.tot&lt; 72.5 1    0 n (1.000000000 0.000000000) *
                            2621) crl.tot&gt;=72.5 11    1 y (0.090909091 0.909090909)  
                              5242) bang&lt; 0.4635 3    1 y (0.333333333 0.666666667)  
                               10484) crl.tot&gt;=78 1    0 n (1.000000000 0.000000000) *
                               10485) crl.tot&lt; 78 2    0 y (0.000000000 1.000000000) *
                              5243) bang&gt;=0.4635 8    0 y (0.000000000 1.000000000) *
                          1311) crl.tot&lt; 71.5 7    0 y (0.000000000 1.000000000) *
                  41) money&gt;=0.835 10    1 y (0.100000000 0.900000000)  
                    82) crl.tot&lt; 39.5 4    1 y (0.250000000 0.750000000)  
                     164) crl.tot&gt;=29.5 1    0 n (1.000000000 0.000000000) *
                     165) crl.tot&lt; 29.5 3    0 y (0.000000000 1.000000000) *
                    83) crl.tot&gt;=39.5 6    0 y (0.000000000 1.000000000) *
                21) bang&gt;=0.7735 117   48 y (0.410256410 0.589743590)  
                  42) crl.tot&lt; 17 43   12 n (0.720930233 0.279069767)  
                    84) bang&lt; 3.959 35    6 n (0.828571429 0.171428571)  
                     168) money&lt; 4.545 34    5 n (0.852941176 0.147058824)  
                       336) bang&gt;=0.8985 29    3 n (0.896551724 0.103448276)  
                         672) bang&lt; 1.5525 18    0 n (1.000000000 0.000000000) *
                         673) bang&gt;=1.5525 11    3 n (0.727272727 0.272727273)  
                          1346) crl.tot&lt; 6.5 5    0 n (1.000000000 0.000000000) *
                          1347) crl.tot&gt;=6.5 6    3 n (0.500000000 0.500000000)  
                            2694) bang&gt;=1.82 4    1 n (0.750000000 0.250000000)  
                              5388) crl.tot&lt; 14.5 3    0 n (1.000000000 0.000000000) *
                              5389) crl.tot&gt;=14.5 1    0 y (0.000000000 1.000000000) *
                            2695) bang&lt; 1.82 2    0 y (0.000000000 1.000000000) *
                       337) bang&lt; 0.8985 5    2 n (0.600000000 0.400000000)  
                         674) crl.tot&lt; 10 2    0 n (1.000000000 0.000000000) *
                         675) crl.tot&gt;=10 3    1 y (0.333333333 0.666666667)  
                          1350) crl.tot&gt;=13 1    0 n (1.000000000 0.000000000) *
                          1351) crl.tot&lt; 13 2    0 y (0.000000000 1.000000000) *
                     169) money&gt;=4.545 1    0 y (0.000000000 1.000000000) *
                    85) bang&gt;=3.959 8    2 y (0.250000000 0.750000000)  
                     170) bang&gt;=8.088 2    0 n (1.000000000 0.000000000) *
                     171) bang&lt; 8.088 6    0 y (0.000000000 1.000000000) *
                  43) crl.tot&gt;=17 74   17 y (0.229729730 0.770270270)  
                    86) bang&gt;=4.8935 6    0 n (1.000000000 0.000000000) *
                    87) bang&lt; 4.8935 68   11 y (0.161764706 0.838235294)  
                     174) crl.tot&lt; 35 19    7 y (0.368421053 0.631578947)  
                       348) crl.tot&gt;=20 16    7 y (0.437500000 0.562500000)  
                         696) crl.tot&lt; 22.5 2    0 n (1.000000000 0.000000000) *
                         697) crl.tot&gt;=22.5 14    5 y (0.357142857 0.642857143)  
                          1394) crl.tot&gt;=25.5 8    4 n (0.500000000 0.500000000)  
                            2788) bang&gt;=1.117 3    0 n (1.000000000 0.000000000) *
                            2789) bang&lt; 1.117 5    1 y (0.200000000 0.800000000)  
                              5578) bang&lt; 0.853 2    1 n (0.500000000 0.500000000)  
                               11156) crl.tot&lt; 32.5 1    0 n (1.000000000 0.000000000) *
                               11157) crl.tot&gt;=32.5 1    0 y (0.000000000 1.000000000) *
                              5579) bang&gt;=0.853 3    0 y (0.000000000 1.000000000) *
                          1395) crl.tot&lt; 25.5 6    1 y (0.166666667 0.833333333)  
                            2790) bang&lt; 1.018 1    0 n (1.000000000 0.000000000) *
                            2791) bang&gt;=1.018 5    0 y (0.000000000 1.000000000) *
                       349) crl.tot&lt; 20 3    0 y (0.000000000 1.000000000) *
                     175) crl.tot&gt;=35 49    4 y (0.081632653 0.918367347)  
                       350) bang&lt; 0.9585 12    3 y (0.250000000 0.750000000)  
                         700) bang&gt;=0.953 1    0 n (1.000000000 0.000000000) *
                         701) bang&lt; 0.953 11    2 y (0.181818182 0.818181818)  
                          1402) bang&gt;=0.8155 8    2 y (0.250000000 0.750000000)  
                            2804) crl.tot&lt; 39.5 1    0 n (1.000000000 0.000000000) *
                            2805) crl.tot&gt;=39.5 7    1 y (0.142857143 0.857142857)  
                              5610) crl.tot&gt;=74 2    1 n (0.500000000 0.500000000)  
                               11220) crl.tot&lt; 79 1    0 n (1.000000000 0.000000000) *
                               11221) crl.tot&gt;=79 1    0 y (0.000000000 1.000000000) *
                              5611) crl.tot&lt; 74 5    0 y (0.000000000 1.000000000) *
                          1403) bang&lt; 0.8155 3    0 y (0.000000000 1.000000000) *
                       351) bang&gt;=0.9585 37    1 y (0.027027027 0.972972973)  
                         702) bang&gt;=1.5385 18    1 y (0.055555556 0.944444444)  
                          1404) bang&lt; 1.549 1    0 n (1.000000000 0.000000000) *
                          1405) bang&gt;=1.549 17    0 y (0.000000000 1.000000000) *
                         703) bang&lt; 1.5385 19    0 y (0.000000000 1.000000000) *
              11) crl.tot&gt;=85.5 516  121 y (0.234496124 0.765503876)  
                22) bang&lt; 0.1955 152   71 y (0.467105263 0.532894737)  
                  44) money&lt; 0.04 117   47 n (0.598290598 0.401709402)  
                    88) dollar&lt; 0.0085 106   38 n (0.641509434 0.358490566)  
                     176) bang&lt; 0.108 15    0 n (1.000000000 0.000000000) *
                     177) bang&gt;=0.108 91   38 n (0.582417582 0.417582418)  
                       354) crl.tot&gt;=125 58   18 n (0.689655172 0.310344828)  
                         708) n000&lt; 0.36 56   16 n (0.714285714 0.285714286)  
                          1416) crl.tot&lt; 323.5 38    8 n (0.789473684 0.210526316)  
                            2832) crl.tot&gt;=234 12    0 n (1.000000000 0.000000000) *
                            2833) crl.tot&lt; 234 26    8 n (0.692307692 0.307692308)  
                              5666) crl.tot&lt; 187.5 22    5 n (0.772727273 0.227272727)  
                               11332) bang&gt;=0.1215 21    4 n (0.809523810 0.190476190)  
                                 22664) crl.tot&lt; 134.5 4    0 n (1.000000000 0.000000000) *
                                 22665) crl.tot&gt;=134.5 17    4 n (0.764705882 0.235294118)  
                                   45330) crl.tot&gt;=136.5 16    3 n (0.812500000 0.187500000)  
                                     90660) crl.tot&lt; 150.5 5    0 n (1.000000000 0.000000000) *
                                     90661) crl.tot&gt;=150.5 11    3 n (0.727272727 0.272727273)  
                                      181322) crl.tot&gt;=152 10    2 n (0.800000000 0.200000000)  
                                        362644) crl.tot&gt;=177 4    0 n (1.000000000 0.000000000) *
                                        362645) crl.tot&lt; 177 6    2 n (0.666666667 0.333333333)  
                                          725290) crl.tot&lt; 173.5 5    1 n (0.800000000 0.200000000)  
                                           1450580) crl.tot&lt; 158.5 2    0 n (1.000000000 0.000000000) *
                                           1450581) crl.tot&gt;=158.5 3    1 n (0.666666667 0.333333333)  
                                             2901162) crl.tot&gt;=161 2    0 n (1.000000000 0.000000000) *
                                             2901163) crl.tot&lt; 161 1    0 y (0.000000000 1.000000000) *
                                          725291) crl.tot&gt;=173.5 1    0 y (0.000000000 1.000000000) *
                                      181323) crl.tot&lt; 152 1    0 y (0.000000000 1.000000000) *
                                   45331) crl.tot&lt; 136.5 1    0 y (0.000000000 1.000000000) *
                               11333) bang&lt; 0.1215 1    0 y (0.000000000 1.000000000) *
                              5667) crl.tot&gt;=187.5 4    1 y (0.250000000 0.750000000)  
                               11334) bang&gt;=0.152 1    0 n (1.000000000 0.000000000) *
                               11335) bang&lt; 0.152 3    0 y (0.000000000 1.000000000) *
                          1417) crl.tot&gt;=323.5 18    8 n (0.555555556 0.444444444)  
                            2834) crl.tot&gt;=664.5 7    1 n (0.857142857 0.142857143)  
                              5668) make&lt; 0.49 6    0 n (1.000000000 0.000000000) *
                              5669) make&gt;=0.49 1    0 y (0.000000000 1.000000000) *
                            2835) crl.tot&lt; 664.5 11    4 y (0.363636364 0.636363636)  
                              5670) make&gt;=0.05 4    1 n (0.750000000 0.250000000)  
                               11340) bang&gt;=0.1315 3    0 n (1.000000000 0.000000000) *
                               11341) bang&lt; 0.1315 1    0 y (0.000000000 1.000000000) *
                              5671) make&lt; 0.05 7    1 y (0.142857143 0.857142857)  
                               11342) bang&gt;=0.1915 1    0 n (1.000000000 0.000000000) *
                               11343) bang&lt; 0.1915 6    0 y (0.000000000 1.000000000) *
                         709) n000&gt;=0.36 2    0 y (0.000000000 1.000000000) *
                       355) crl.tot&lt; 125 33   13 y (0.393939394 0.606060606)  
                         710) bang&gt;=0.1805 4    0 n (1.000000000 0.000000000) *
                         711) bang&lt; 0.1805 29    9 y (0.310344828 0.689655172)  
                          1422) bang&lt; 0.12 11    5 n (0.545454545 0.454545455)  
                            2844) bang&gt;=0.1125 5    1 n (0.800000000 0.200000000)  
                              5688) crl.tot&lt; 99 2    0 n (1.000000000 0.000000000) *
                              5689) crl.tot&gt;=99 3    1 n (0.666666667 0.333333333)  
                               11378) crl.tot&gt;=111.5 1    0 n (1.000000000 0.000000000) *
                               11379) crl.tot&lt; 111.5 2    1 n (0.500000000 0.500000000)  
                                 22758) bang&gt;=0.118 1    0 n (1.000000000 0.000000000) *
                                 22759) bang&lt; 0.118 1    0 y (0.000000000 1.000000000) *
                            2845) bang&lt; 0.1125 6    2 y (0.333333333 0.666666667)  
                              5690) crl.tot&gt;=92 4    2 n (0.500000000 0.500000000)  
                               11380) crl.tot&lt; 104 1    0 n (1.000000000 0.000000000) *
                               11381) crl.tot&gt;=104 3    1 y (0.333333333 0.666666667)  
                                 22762) crl.tot&gt;=113.5 2    1 n (0.500000000 0.500000000)  
                                   45524) crl.tot&lt; 116 1    0 n (1.000000000 0.000000000) *
                                   45525) crl.tot&gt;=116 1    0 y (0.000000000 1.000000000) *
                                 22763) crl.tot&lt; 113.5 1    0 y (0.000000000 1.000000000) *
                              5691) crl.tot&lt; 92 2    0 y (0.000000000 1.000000000) *
                          1423) bang&gt;=0.12 18    3 y (0.166666667 0.833333333)  
                            2846) crl.tot&lt; 89 1    0 n (1.000000000 0.000000000) *
                            2847) crl.tot&gt;=89 17    2 y (0.117647059 0.882352941)  
                              5694) crl.tot&gt;=99.5 9    2 y (0.222222222 0.777777778)  
                               11388) crl.tot&lt; 104 1    0 n (1.000000000 0.000000000) *
                               11389) crl.tot&gt;=104 8    1 y (0.125000000 0.875000000)  
                                 22778) bang&gt;=0.1665 2    1 n (0.500000000 0.500000000)  
                                   45556) crl.tot&gt;=115.5 1    0 n (1.000000000 0.000000000) *
                                   45557) crl.tot&lt; 115.5 1    0 y (0.000000000 1.000000000) *
                                 22779) bang&lt; 0.1665 6    0 y (0.000000000 1.000000000) *
                              5695) crl.tot&lt; 99.5 8    0 y (0.000000000 1.000000000) *
                    89) dollar&gt;=0.0085 11    2 y (0.181818182 0.818181818)  
                     178) crl.tot&lt; 264.5 3    1 n (0.666666667 0.333333333)  
                       356) crl.tot&gt;=124 2    0 n (1.000000000 0.000000000) *
                       357) crl.tot&lt; 124 1    0 y (0.000000000 1.000000000) *
                     179) crl.tot&gt;=264.5 8    0 y (0.000000000 1.000000000) *
                  45) money&gt;=0.04 35    1 y (0.028571429 0.971428571)  
                    90) crl.tot&lt; 90.5 1    0 n (1.000000000 0.000000000) *
                    91) crl.tot&gt;=90.5 34    0 y (0.000000000 1.000000000) *
                23) bang&gt;=0.1955 364   50 y (0.137362637 0.862637363)  
                  46) bang&lt; 0.5155 183   44 y (0.240437158 0.759562842)  
                    92) crl.tot&lt; 180 67   33 y (0.492537313 0.507462687)  
                     184) money&lt; 0.22 63   30 n (0.523809524 0.476190476)  
                       368) make&gt;=0.065 10    2 n (0.800000000 0.200000000)  
                         736) bang&lt; 0.337 4    0 n (1.000000000 0.000000000) *
                         737) bang&gt;=0.337 6    2 n (0.666666667 0.333333333)  
                          1474) bang&gt;=0.4055 3    0 n (1.000000000 0.000000000) *
                          1475) bang&lt; 0.4055 3    1 y (0.333333333 0.666666667)  
                            2950) make&gt;=0.72 1    0 n (1.000000000 0.000000000) *
                            2951) make&lt; 0.72 2    0 y (0.000000000 1.000000000) *
                       369) make&lt; 0.065 53   25 y (0.471698113 0.528301887)  
                         738) crl.tot&lt; 131 31   13 n (0.580645161 0.419354839)  
                          1476) n000&lt; 0.155 29   11 n (0.620689655 0.379310345)  
                            2952) crl.tot&gt;=108.5 8    1 n (0.875000000 0.125000000)  
                              5904) bang&lt; 0.382 5    0 n (1.000000000 0.000000000) *
                              5905) bang&gt;=0.382 3    1 n (0.666666667 0.333333333)  
                               11810) bang&gt;=0.4025 2    0 n (1.000000000 0.000000000) *
                               11811) bang&lt; 0.4025 1    0 y (0.000000000 1.000000000) *
                            2953) crl.tot&lt; 108.5 21   10 n (0.523809524 0.476190476)  
                              5906) crl.tot&lt; 91.5 4    0 n (1.000000000 0.000000000) *
                              5907) crl.tot&gt;=91.5 17    7 y (0.411764706 0.588235294)  
                               11814) crl.tot&lt; 106.5 14    7 n (0.500000000 0.500000000)  
                                 23628) crl.tot&gt;=97.5 7    2 n (0.714285714 0.285714286)  
                                   47256) crl.tot&lt; 103 4    0 n (1.000000000 0.000000000) *
                                   47257) crl.tot&gt;=103 3    1 y (0.333333333 0.666666667)  
                                     94514) crl.tot&gt;=105 1    0 n (1.000000000 0.000000000) *
                                     94515) crl.tot&lt; 105 2    0 y (0.000000000 1.000000000) *
                                 23629) crl.tot&lt; 97.5 7    2 y (0.285714286 0.714285714)  
                                   47258) bang&lt; 0.2005 1    0 n (1.000000000 0.000000000) *
                                   47259) bang&gt;=0.2005 6    1 y (0.166666667 0.833333333)  
                                     94518) bang&gt;=0.3885 2    1 n (0.500000000 0.500000000)  
                                      189036) crl.tot&gt;=93 1    0 n (1.000000000 0.000000000) *
                                      189037) crl.tot&lt; 93 1    0 y (0.000000000 1.000000000) *
                                     94519) bang&lt; 0.3885 4    0 y (0.000000000 1.000000000) *
                               11815) crl.tot&gt;=106.5 3    0 y (0.000000000 1.000000000) *
                          1477) n000&gt;=0.155 2    0 y (0.000000000 1.000000000) *
                         739) crl.tot&gt;=131 22    7 y (0.318181818 0.681818182)  
                          1478) crl.tot&gt;=139 16    7 y (0.437500000 0.562500000)  
                            2956) bang&lt; 0.2875 3    0 n (1.000000000 0.000000000) *
                            2957) bang&gt;=0.2875 13    4 y (0.307692308 0.692307692)  
                              5914) crl.tot&gt;=176.5 1    0 n (1.000000000 0.000000000) *
                              5915) crl.tot&lt; 176.5 12    3 y (0.250000000 0.750000000)  
                               11830) crl.tot&lt; 157.5 4    2 n (0.500000000 0.500000000)  
                                 23660) bang&gt;=0.3285 2    0 n (1.000000000 0.000000000) *
                                 23661) bang&lt; 0.3285 2    0 y (0.000000000 1.000000000) *
                               11831) crl.tot&gt;=157.5 8    1 y (0.125000000 0.875000000)  
                                 23662) bang&lt; 0.303 2    1 n (0.500000000 0.500000000)  
                                   47324) crl.tot&lt; 167.5 1    0 n (1.000000000 0.000000000) *
                                   47325) crl.tot&gt;=167.5 1    0 y (0.000000000 1.000000000) *
                                 23663) bang&gt;=0.303 6    0 y (0.000000000 1.000000000) *
                          1479) crl.tot&lt; 139 6    0 y (0.000000000 1.000000000) *
                     185) money&gt;=0.22 4    0 y (0.000000000 1.000000000) *
                    93) crl.tot&gt;=180 116   11 y (0.094827586 0.905172414)  
                     186) money&lt; 0.045 77   11 y (0.142857143 0.857142857)  
                       372) dollar&gt;=0.0475 1    0 n (1.000000000 0.000000000) *
                       373) dollar&lt; 0.0475 76   10 y (0.131578947 0.868421053)  
                         746) bang&lt; 0.474 61   10 y (0.163934426 0.836065574)  
                          1492) crl.tot&lt; 788.5 50   10 y (0.200000000 0.800000000)  
                            2984) crl.tot&gt;=583.5 2    0 n (1.000000000 0.000000000) *
                            2985) crl.tot&lt; 583.5 48    8 y (0.166666667 0.833333333)  
                              5970) bang&gt;=0.239 31    8 y (0.258064516 0.741935484)  
                               11940) bang&lt; 0.3465 14    6 y (0.428571429 0.571428571)  
                                 23880) bang&gt;=0.332 2    0 n (1.000000000 0.000000000) *
                                 23881) bang&lt; 0.332 12    4 y (0.333333333 0.666666667)  
                                   47762) bang&lt; 0.241 1    0 n (1.000000000 0.000000000) *
                                   47763) bang&gt;=0.241 11    3 y (0.272727273 0.727272727)  
                                     95526) bang&gt;=0.268 7    3 y (0.428571429 0.571428571)  
                                      191052) bang&lt; 0.308 4    1 n (0.750000000 0.250000000)  
                                        382104) crl.tot&gt;=319.5 2    0 n (1.000000000 0.000000000) *
                                        382105) crl.tot&lt; 319.5 2    1 n (0.500000000 0.500000000)  
                                          764210) crl.tot&lt; 301.5 1    0 n (1.000000000 0.000000000) *
                                          764211) crl.tot&gt;=301.5 1    0 y (0.000000000 1.000000000) *
                                      191053) bang&gt;=0.308 3    0 y (0.000000000 1.000000000) *
                                     95527) bang&lt; 0.268 4    0 y (0.000000000 1.000000000) *
                               11941) bang&gt;=0.3465 17    2 y (0.117647059 0.882352941)  
                                 23882) bang&gt;=0.436 5    2 y (0.400000000 0.600000000)  
                                   47764) crl.tot&lt; 355 3    1 n (0.666666667 0.333333333)  
                                     95528) crl.tot&gt;=236.5 2    0 n (1.000000000 0.000000000) *
                                     95529) crl.tot&lt; 236.5 1    0 y (0.000000000 1.000000000) *
                                   47765) crl.tot&gt;=355 2    0 y (0.000000000 1.000000000) *
                                 23883) bang&lt; 0.436 12    0 y (0.000000000 1.000000000) *
                              5971) bang&lt; 0.239 17    0 y (0.000000000 1.000000000) *
                          1493) crl.tot&gt;=788.5 11    0 y (0.000000000 1.000000000) *
                         747) bang&gt;=0.474 15    0 y (0.000000000 1.000000000) *
                     187) money&gt;=0.045 39    0 y (0.000000000 1.000000000) *
                  47) bang&gt;=0.5155 181    6 y (0.033149171 0.966850829)  
                    94) make&gt;=0.685 6    2 y (0.333333333 0.666666667)  
                     188) money&lt; 0.355 3    1 n (0.666666667 0.333333333)  
                       376) crl.tot&gt;=116 2    0 n (1.000000000 0.000000000) *
                       377) crl.tot&lt; 116 1    0 y (0.000000000 1.000000000) *
                     189) money&gt;=0.355 3    0 y (0.000000000 1.000000000) *
                    95) make&lt; 0.685 175    4 y (0.022857143 0.977142857)  
                     190) dollar&gt;=0.049 5    1 y (0.200000000 0.800000000)  
                       380) crl.tot&gt;=629.5 2    1 n (0.500000000 0.500000000)  
                         760) crl.tot&lt; 647.5 1    0 n (1.000000000 0.000000000) *
                         761) crl.tot&gt;=647.5 1    0 y (0.000000000 1.000000000) *
                       381) crl.tot&lt; 629.5 3    0 y (0.000000000 1.000000000) *
                     191) dollar&lt; 0.049 170    3 y (0.017647059 0.982352941)  
                       382) crl.tot&lt; 142.5 66    3 y (0.045454545 0.954545455)  
                         764) crl.tot&gt;=141.5 1    0 n (1.000000000 0.000000000) *
                         765) crl.tot&lt; 141.5 65    2 y (0.030769231 0.969230769)  
                          1530) crl.tot&gt;=135 6    1 y (0.166666667 0.833333333)  
                            3060) crl.tot&lt; 136.5 1    0 n (1.000000000 0.000000000) *
                            3061) crl.tot&gt;=136.5 5    0 y (0.000000000 1.000000000) *
                          1531) crl.tot&lt; 135 59    1 y (0.016949153 0.983050847)  
                            3062) crl.tot&lt; 104 23    1 y (0.043478261 0.956521739)  
                              6124) crl.tot&gt;=102 1    0 n (1.000000000 0.000000000) *
                              6125) crl.tot&lt; 102 22    0 y (0.000000000 1.000000000) *
                            3063) crl.tot&gt;=104 36    0 y (0.000000000 1.000000000) *
                       383) crl.tot&gt;=142.5 104    0 y (0.000000000 1.000000000) *
           3) dollar&gt;=0.0555 1130  133 y (0.117699115 0.882300885)  
             6) bang&lt; 0.0495 235   89 y (0.378723404 0.621276596)  
              12) money&lt; 0.025 141   59 n (0.581560284 0.418439716)  
                24) n000&lt; 0.465 126   44 n (0.650793651 0.349206349)  
                  48) dollar&lt; 0.1665 70   11 n (0.842857143 0.157142857)  
                    96) crl.tot&lt; 107.5 19    0 n (1.000000000 0.000000000) *
                    97) crl.tot&gt;=107.5 51   11 n (0.784313725 0.215686275)  
                     194) make&lt; 0.23 48    8 n (0.833333333 0.166666667)  
                       388) crl.tot&gt;=116 42    4 n (0.904761905 0.095238095)  
                         776) crl.tot&gt;=302.5 27    0 n (1.000000000 0.000000000) *
                         777) crl.tot&lt; 302.5 15    4 n (0.733333333 0.266666667)  
                          1554) crl.tot&lt; 274.5 13    2 n (0.846153846 0.153846154)  
                            3108) dollar&gt;=0.066 12    1 n (0.916666667 0.083333333)  
                              6216) dollar&gt;=0.0905 9    0 n (1.000000000 0.000000000) *
                              6217) dollar&lt; 0.0905 3    1 n (0.666666667 0.333333333)  
                               12434) dollar&lt; 0.087 2    0 n (1.000000000 0.000000000) *
                               12435) dollar&gt;=0.087 1    0 y (0.000000000 1.000000000) *
                            3109) dollar&lt; 0.066 1    0 y (0.000000000 1.000000000) *
                          1555) crl.tot&gt;=274.5 2    0 y (0.000000000 1.000000000) *
                       389) crl.tot&lt; 116 6    2 y (0.333333333 0.666666667)  
                         778) dollar&lt; 0.096 2    0 n (1.000000000 0.000000000) *
                         779) dollar&gt;=0.096 4    0 y (0.000000000 1.000000000) *
                     195) make&gt;=0.23 3    0 y (0.000000000 1.000000000) *
                  49) dollar&gt;=0.1665 56   23 y (0.410714286 0.589285714)  
                    98) dollar&gt;=0.1925 45   22 n (0.511111111 0.488888889)  
                     196) dollar&lt; 1.012 38   16 n (0.578947368 0.421052632)  
                       392) dollar&gt;=0.3595 17    4 n (0.764705882 0.235294118)  
                         784) crl.tot&lt; 21 3    0 n (1.000000000 0.000000000) *
                         785) crl.tot&gt;=21 14    4 n (0.714285714 0.285714286)  
                          1570) crl.tot&gt;=35.5 11    2 n (0.818181818 0.181818182)  
                            3140) crl.tot&lt; 82 5    0 n (1.000000000 0.000000000) *
                            3141) crl.tot&gt;=82 6    2 n (0.666666667 0.333333333)  
                              6282) dollar&lt; 0.607 3    0 n (1.000000000 0.000000000) *
                              6283) dollar&gt;=0.607 3    1 y (0.333333333 0.666666667)  
                               12566) dollar&gt;=0.7745 1    0 n (1.000000000 0.000000000) *
                               12567) dollar&lt; 0.7745 2    0 y (0.000000000 1.000000000) *
                          1571) crl.tot&lt; 35.5 3    1 y (0.333333333 0.666666667)  
                            3142) crl.tot&lt; 29 2    1 n (0.500000000 0.500000000)  
                              6284) dollar&gt;=0.601 1    0 n (1.000000000 0.000000000) *
                              6285) dollar&lt; 0.601 1    0 y (0.000000000 1.000000000) *
                            3143) crl.tot&gt;=29 1    0 y (0.000000000 1.000000000) *
                       393) dollar&lt; 0.3595 21    9 y (0.428571429 0.571428571)  
                         786) dollar&lt; 0.2115 3    0 n (1.000000000 0.000000000) *
                         787) dollar&gt;=0.2115 18    6 y (0.333333333 0.666666667)  
                          1574) dollar&lt; 0.3345 14    6 y (0.428571429 0.571428571)  
                            3148) make&lt; 0.145 12    6 n (0.500000000 0.500000000)  
                              6296) dollar&gt;=0.217 8    3 n (0.625000000 0.375000000)  
                               12592) crl.tot&gt;=23.5 7    2 n (0.714285714 0.285714286)  
                                 25184) crl.tot&lt; 178.5 6    1 n (0.833333333 0.166666667)  
                                   50368) crl.tot&gt;=64 3    0 n (1.000000000 0.000000000) *
                                   50369) crl.tot&lt; 64 3    1 n (0.666666667 0.333333333)  
                                    100738) crl.tot&lt; 53 2    0 n (1.000000000 0.000000000) *
                                    100739) crl.tot&gt;=53 1    0 y (0.000000000 1.000000000) *
                                 25185) crl.tot&gt;=178.5 1    0 y (0.000000000 1.000000000) *
                               12593) crl.tot&lt; 23.5 1    0 y (0.000000000 1.000000000) *
                              6297) dollar&lt; 0.217 4    1 y (0.250000000 0.750000000)  
                               12594) crl.tot&gt;=217.5 1    0 n (1.000000000 0.000000000) *
                               12595) crl.tot&lt; 217.5 3    0 y (0.000000000 1.000000000) *
                            3149) make&gt;=0.145 2    0 y (0.000000000 1.000000000) *
                          1575) dollar&gt;=0.3345 4    0 y (0.000000000 1.000000000) *
                     197) dollar&gt;=1.012 7    1 y (0.142857143 0.857142857)  
                       394) dollar&gt;=1.8245 3    1 y (0.333333333 0.666666667)  
                         788) crl.tot&gt;=239 1    0 n (1.000000000 0.000000000) *
                         789) crl.tot&lt; 239 2    0 y (0.000000000 1.000000000) *
                       395) dollar&lt; 1.8245 4    0 y (0.000000000 1.000000000) *
                    99) dollar&lt; 0.1925 11    0 y (0.000000000 1.000000000) *
                25) n000&gt;=0.465 15    0 y (0.000000000 1.000000000) *
              13) money&gt;=0.025 94    7 y (0.074468085 0.925531915)  
                26) crl.tot&lt; 50 2    0 n (1.000000000 0.000000000) *
                27) crl.tot&gt;=50 92    5 y (0.054347826 0.945652174)  
                  54) dollar&gt;=0.3635 1    0 n (1.000000000 0.000000000) *
                  55) dollar&lt; 0.3635 91    4 y (0.043956044 0.956043956)  
                   110) dollar&lt; 0.1315 15    4 y (0.266666667 0.733333333)  
                     220) dollar&gt;=0.0995 4    1 n (0.750000000 0.250000000)  
                       440) n000&lt; 0.745 3    0 n (1.000000000 0.000000000) *
                       441) n000&gt;=0.745 1    0 y (0.000000000 1.000000000) *
                     221) dollar&lt; 0.0995 11    1 y (0.090909091 0.909090909)  
                       442) bang&gt;=0.0285 1    0 n (1.000000000 0.000000000) *
                       443) bang&lt; 0.0285 10    0 y (0.000000000 1.000000000) *
                   111) dollar&gt;=0.1315 76    0 y (0.000000000 1.000000000) *
             7) bang&gt;=0.0495 895   44 y (0.049162011 0.950837989)  
              14) crl.tot&lt; 27.5 2    0 n (1.000000000 0.000000000) *
              15) crl.tot&gt;=27.5 893   42 y (0.047032475 0.952967525)  
                30) bang&lt; 0.376 412   38 y (0.092233010 0.907766990)  
                  60) money&lt; 0.025 201   32 y (0.159203980 0.840796020)  
                   120) n000&lt; 1.01 162   32 y (0.197530864 0.802469136)  
                     240) bang&lt; 0.143 51   17 y (0.333333333 0.666666667)  
                       480) bang&gt;=0.0705 35   16 y (0.457142857 0.542857143)  
                         960) dollar&lt; 0.0825 11    2 n (0.818181818 0.181818182)  
                          1920) dollar&gt;=0.0585 9    0 n (1.000000000 0.000000000) *
                          1921) dollar&lt; 0.0585 2    0 y (0.000000000 1.000000000) *
                         961) dollar&gt;=0.0825 24    7 y (0.291666667 0.708333333)  
                          1922) dollar&lt; 0.287 18    7 y (0.388888889 0.611111111)  
                            3844) dollar&gt;=0.1855 5    0 n (1.000000000 0.000000000) *
                            3845) dollar&lt; 0.1855 13    2 y (0.153846154 0.846153846)  
                              7690) crl.tot&gt;=745.5 1    0 n (1.000000000 0.000000000) *
                              7691) crl.tot&lt; 745.5 12    1 y (0.083333333 0.916666667)  
                               15382) bang&lt; 0.079 1    0 n (1.000000000 0.000000000) *
                               15383) bang&gt;=0.079 11    0 y (0.000000000 1.000000000) *
                          1923) dollar&gt;=0.287 6    0 y (0.000000000 1.000000000) *
                       481) bang&lt; 0.0705 16    1 y (0.062500000 0.937500000)  
                         962) crl.tot&gt;=566.5 3    1 y (0.333333333 0.666666667)  
                          1924) crl.tot&lt; 881 1    0 n (1.000000000 0.000000000) *
                          1925) crl.tot&gt;=881 2    0 y (0.000000000 1.000000000) *
                         963) crl.tot&lt; 566.5 13    0 y (0.000000000 1.000000000) *
                     241) bang&gt;=0.143 111   15 y (0.135135135 0.864864865)  
                       482) bang&gt;=0.2765 43   13 y (0.302325581 0.697674419)  
                         964) dollar&gt;=0.1775 11    3 n (0.727272727 0.272727273)  
                          1928) bang&lt; 0.3625 9    1 n (0.888888889 0.111111111)  
                            3856) crl.tot&lt; 104 6    0 n (1.000000000 0.000000000) *
                            3857) crl.tot&gt;=104 3    1 n (0.666666667 0.333333333)  
                              7714) crl.tot&gt;=119.5 2    0 n (1.000000000 0.000000000) *
                              7715) crl.tot&lt; 119.5 1    0 y (0.000000000 1.000000000) *
                          1929) bang&gt;=0.3625 2    0 y (0.000000000 1.000000000) *
                         965) dollar&lt; 0.1775 32    5 y (0.156250000 0.843750000)  
                          1930) crl.tot&lt; 61.5 6    3 n (0.500000000 0.500000000)  
                            3860) make&lt; 0.37 3    0 n (1.000000000 0.000000000) *
                            3861) make&gt;=0.37 3    0 y (0.000000000 1.000000000) *
                          1931) crl.tot&gt;=61.5 26    2 y (0.076923077 0.923076923)  
                            3862) bang&gt;=0.3735 1    0 n (1.000000000 0.000000000) *
                            3863) bang&lt; 0.3735 25    1 y (0.040000000 0.960000000)  
                              7726) crl.tot&lt; 101 7    1 y (0.142857143 0.857142857)  
                               15452) crl.tot&gt;=82 1    0 n (1.000000000 0.000000000) *
                               15453) crl.tot&lt; 82 6    0 y (0.000000000 1.000000000) *
                              7727) crl.tot&gt;=101 18    0 y (0.000000000 1.000000000) *
                       483) bang&lt; 0.2765 68    2 y (0.029411765 0.970588235)  
                         966) crl.tot&lt; 55.5 6    1 y (0.166666667 0.833333333)  
                          1932) crl.tot&gt;=51 1    0 n (1.000000000 0.000000000) *
                          1933) crl.tot&lt; 51 5    0 y (0.000000000 1.000000000) *
                         967) crl.tot&gt;=55.5 62    1 y (0.016129032 0.983870968)  
                          1934) dollar&gt;=0.331 14    1 y (0.071428571 0.928571429)  
                            3868) dollar&lt; 0.3385 1    0 n (1.000000000 0.000000000) *
                            3869) dollar&gt;=0.3385 13    0 y (0.000000000 1.000000000) *
                          1935) dollar&lt; 0.331 48    0 y (0.000000000 1.000000000) *
                   121) n000&gt;=1.01 39    0 y (0.000000000 1.000000000) *
                  61) money&gt;=0.025 211    6 y (0.028436019 0.971563981)  
                   122) crl.tot&lt; 161.5 31    5 y (0.161290323 0.838709677)  
                     244) crl.tot&gt;=105 12    5 y (0.416666667 0.583333333)  
                       488) bang&gt;=0.2135 3    0 n (1.000000000 0.000000000) *
                       489) bang&lt; 0.2135 9    2 y (0.222222222 0.777777778)  
                         978) money&gt;=0.655 3    1 n (0.666666667 0.333333333) *
                         979) money&lt; 0.655 6    0 y (0.000000000 1.000000000) *
                     245) crl.tot&lt; 105 19    0 y (0.000000000 1.000000000) *
                   123) crl.tot&gt;=161.5 180    1 y (0.005555556 0.994444444)  
                     246) bang&gt;=0.3715 4    1 y (0.250000000 0.750000000)  
                       492) dollar&gt;=0.2095 1    0 n (1.000000000 0.000000000) *
                       493) dollar&lt; 0.2095 3    0 y (0.000000000 1.000000000) *
                     247) bang&lt; 0.3715 176    0 y (0.000000000 1.000000000) *
                31) bang&gt;=0.376 481    4 y (0.008316008 0.991683992)  
                  62) crl.tot&lt; 35 4    1 y (0.250000000 0.750000000)  
                   124) crl.tot&gt;=33.5 1    0 n (1.000000000 0.000000000) *
                   125) crl.tot&lt; 33.5 3    0 y (0.000000000 1.000000000) *
                  63) crl.tot&gt;=35 477    3 y (0.006289308 0.993710692)  
                   126) money&gt;=1.035 30    1 y (0.033333333 0.966666667)  
                     252) money&lt; 1.055 3    1 y (0.333333333 0.666666667)  
                       504) dollar&lt; 0.1385 1    0 n (1.000000000 0.000000000) *
                       505) dollar&gt;=0.1385 2    0 y (0.000000000 1.000000000) *
                     253) money&gt;=1.055 27    0 y (0.000000000 1.000000000) *
                   127) money&lt; 1.035 447    2 y (0.004474273 0.995525727)  
                     254) bang&lt; 0.4075 32    1 y (0.031250000 0.968750000)  
                       508) bang&gt;=0.4065 2    1 n (0.500000000 0.500000000)  
                        1016) crl.tot&lt; 191 1    0 n (1.000000000 0.000000000) *
                        1017) crl.tot&gt;=191 1    0 y (0.000000000 1.000000000) *
                       509) bang&lt; 0.4065 30    0 y (0.000000000 1.000000000) *
                     255) bang&gt;=0.4075 415    1 y (0.002409639 0.997590361)  
                       510) dollar&lt; 0.1595 128    1 y (0.007812500 0.992187500)  
                        1020) dollar&gt;=0.1585 1    0 n (1.000000000 0.000000000) *
                        1021) dollar&lt; 0.1585 127    0 y (0.000000000 1.000000000) *
                       511) dollar&gt;=0.1595 287    0 y (0.000000000 1.000000000) *</code></pre>
</div>
</div>
<p>Training error on tree with pre-pruning</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(tree_default, spam) <span class="sc">|&gt;</span> <span class="fu">head</span> ()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          n         y
1 0.2344961 0.7655039
2 0.1176991 0.8823009
3 0.1176991 0.8823009
4 0.2344961 0.7655039
5 0.2344961 0.7655039
6 0.8983471 0.1016529</code></pre>
</div>
</div>
<p>Class predictions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(tree_default, spam, <span class="at">type=</span><span class="st">"class"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 2 3 4 5 6 
y y y y y n 
Levels: n y</code></pre>
</div>
</div>
<p>Confusion matrices for prediction, true values, correct and incorrect values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>confusion_table <span class="ot">&lt;-</span> <span class="fu">with</span>(spam, <span class="fu">table</span>(yesno, pred))</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>confusion_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     pred
yesno    n    y
    n 2517  271
    y  364 1449</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>correct <span class="ot">&lt;-</span> confusion_table <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>correct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3966</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> confusion_table <span class="sc">|&gt;</span> <span class="fu">sum</span>() <span class="sc">-</span> correct</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>error</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 635</code></pre>
</div>
</div>
<p>Calculating accuracy</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> correct <span class="sc">/</span> (correct <span class="sc">+</span> error)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8619865</code></pre>
</div>
</div>
<p>Using a function for finding accuracy</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="cf">function</span>(truth, prediction) {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(truth, prediction)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">diag</span>(tbl))<span class="sc">/</span><span class="fu">sum</span>(tbl)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(spam <span class="sc">|&gt;</span> <span class="fu">pull</span>(yesno), pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.8619865</code></pre>
</div>
</div>
<p>Training error of full tree</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(spam <span class="sc">|&gt;</span> <span class="fu">pull</span>(yesno), </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">predict</span>(tree_full, spam, <span class="at">type =</span> <span class="st">"class"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9702239</code></pre>
</div>
</div>
<p>Getting a confusion table with more statistics (using caret)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="at">data =</span> pred, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">reference =</span> spam <span class="sc">|&gt;</span> <span class="fu">pull</span>(yesno))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    n    y
         n 2517  364
         y  271 1449
                                          
               Accuracy : 0.862           
                 95% CI : (0.8517, 0.8718)
    No Information Rate : 0.606           
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7084          
                                          
 Mcnemar's Test P-Value : 0.0002613       
                                          
            Sensitivity : 0.9028          
            Specificity : 0.7992          
         Pos Pred Value : 0.8737          
         Neg Pred Value : 0.8424          
             Prevalence : 0.6060          
         Detection Rate : 0.5471          
   Detection Prevalence : 0.6262          
      Balanced Accuracy : 0.8510          
                                          
       'Positive' Class : n               
                                          </code></pre>
</div>
</div>
</section>
<section id="make-predictions-for-new-data" class="level3">
<h3 class="anchored" data-anchor-id="make-predictions-for-new-data"><strong>Make Predictions for New Data</strong></h3>
<p>Make up my own sequence of digits and special characters as spam</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>my_spam <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">crl.tot =</span> <span class="dv">20</span>, <span class="at">dollar =</span> <span class="fl">0.5</span>, <span class="at">bang =</span> <span class="fl">0.6</span>, <span class="at">money =</span> <span class="fl">0.3</span>, <span class="at">n000 =</span> <span class="fl">0.9</span>, <span class="at">make =</span> <span class="fl">0.8</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Making a prediction using tree default</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(tree_default , my_spam, <span class="at">type =</span> <span class="st">"class"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 
y 
Levels: n y</code></pre>
</div>
</div>
</section>
</section>
<section id="model-evaluation-with-caret" class="level2">
<h2 class="anchored" data-anchor-id="model-evaluation-with-caret"><strong>Model Evaluation with Caret</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Set random number generator seed to make results reproducible</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="hold-out-test-data" class="level3">
<h3 class="anchored" data-anchor-id="hold-out-test-data"><strong>Hold out Test Data</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>inTrain <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(<span class="at">y =</span> spam<span class="sc">$</span>yesno, <span class="at">p =</span> .<span class="dv">8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>spam_train <span class="ot">&lt;-</span> spam <span class="sc">|&gt;</span> <span class="fu">slice</span>(inTrain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Slicing with a 1-column matrix was deprecated in dplyr 1.1.0.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#We are splitting the dataset into testing and training sets with a proportion of 80:20 resp.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>spam_test <span class="ot">&lt;-</span> spam <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="sc">-</span>inTrain) </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="co">#The remaining dataset after the slicing for the training (spam_train) is stored in spam_test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="learn-a-model-and-tune-hyperparameters-on-the-training-data" class="level3">
<h3 class="anchored" data-anchor-id="learn-a-model-and-tune-hyperparameters-on-the-training-data"><strong>Learn a Model and Tune Hyperparameters on the Training Data</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">train</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _ ,</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"rpart"</span>,</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">minsplit =</span> <span class="dv">2</span>),</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">5</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CART 

3682 samples
   6 predictor
   2 classes: 'n', 'y' 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 3313, 3314, 3314, 3314, 3314, 3314, ... 
Resampling results across tuning parameters:

  cp           Accuracy   Kappa    
  0.005513439  0.8590462  0.6991218
  0.005858029  0.8560571  0.6938464
  0.010682288  0.8468172  0.6737240
  0.077877326  0.7976700  0.5604247
  0.470709855  0.6727237  0.1948272

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was cp = 0.005513439.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we are training the model with the parameters and hyperparameters are tuned using tunelength.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(fit<span class="sc">$</span>finalModel, <span class="at">extra =</span> <span class="dv">2</span>,</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">box.palette =</span> <span class="fu">list</span>(<span class="st">"Rd"</span>, <span class="st">"Bu"</span>, <span class="st">"Or"</span>,<span class="st">"Gy"</span>, <span class="st">"Gn"</span>, <span class="st">"Bn"</span>, <span class="st">"Pu"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># A model using the best tuning parameters and using all the data supplied to train() is available as fit$finalModel.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above decision in the best model after tuning the hyperparameters using tunelength. Here it takes dollar, bang, crl.tot and money for arriving at a decision.<br>
<br>
<br>
Printing important scores of each features</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rpart variable importance

        Overall
bang     100.00
dollar    73.20
money     66.14
crl.tot   56.09
n000      48.78
make       0.00</code></pre>
</div>
</div>
<p>The above are the importance scores of features. Bang being the most relevant and make not being relevant at all.</p>
<p>Feature importance without competing splits.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">varImp</span>(fit, <span class="at">compete =</span> <span class="cn">FALSE</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>imp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rpart variable importance

        Overall
dollar  100.000
bang     45.724
crl.tot  17.957
money     2.283
make      0.000
n000      0.000</code></pre>
</div>
</div>
<p>The above are the importance score of features without compete. Here n000 and make are 0 and dollar is 100 now.</p>
<p>plotting the importance</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(imp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="testing-confusion-matrix-and-confidence-interval-for-accuracy" class="level2">
<h2 class="anchored" data-anchor-id="testing-confusion-matrix-and-confidence-interval-for-accuracy"><strong>Testing: Confusion Matrix and Confidence Interval for Accuracy</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> spam_test)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] y y n y y y y y y y y y y y y n y y y n n y n y y y y y y y n y y n n y y
 [38] y y n y y y y y n y n y y y y y y y y n n y y y y y y y y y y y y y y y n
 [75] n y y n y y y n y y y y y n y n n y n y y y n y y y y y y y y n y y n y y
[112] n y y y n y y y n y y y y y y y y y y y y n y y n y y n y y y y y y y y n
[149] y y y y y y y n y y y n y y y y y n y y y n y n y y n n y y y y y y y y y
[186] y n n n n y y y y y y y y y y n y y y y y y y y y y y y y y y y y y n n y
[223] y y y y y y n y y y y y y y y y y y y n n y y y y y y y n n y y y y n y y
[260] y y y y y n y y y y n n y y y y n y y y n n y n n y y y y y y y n n y n y
[297] y y y y y y y y y y n y n y n n y n y y y y y y y y y y n y n y y y n y y
[334] y y y n y n y n y y y y n y y y y y y y y y y y n y n y n n n n n n n n n
[371] y n n n n n n n n y n n n n n n n n n n n n n n n n n n n n y n n n n n y
[408] n n y n n n n n n n n n n n y n n n y n n n n n n n n n y n n n n n n n n
[445] y n n n n n n n n n n n n n n y n n n n n n n n y n n n n n n n n n y n n
[482] n n n n n n n n n n n n y n n n n n n n n n n n n n n n n n n n n n n y n
[519] y n n n n n n y n n n n n n n n n n n n n n n n n n n n n n n n n n n n n
[556] n n n n n n n n n n n n n n n n n n n n n n n n n n n n n y n n n n n n y
[593] n n n n n n n y n n n n n n n n n n y n n n n n n n n n n n n n n n n n n
[630] n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n
[667] n n n n n n n n n y n n n n n n n n n n n n n n y y n n n n n n n n n n n
[704] n y n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n
[741] n n n n n n n n n n n n n n n n n n n n n n n n n n y n y n n n n n n n n
[778] n n n n n n n n n n n n n n y n n n n n n n n n n n n n n n n n n n y n y
[815] n n n n n n n n n n n n n n n n n n n y n n n n n n n n n n y n n n n n n
[852] n n n n y n n n n n y n n y n n n n n n n n n y n n n n n n y n n y n n y
[889] n n y n n n n y n n n n n y n n n n n n n n n n n n n n n n n
Levels: n y</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="at">data =</span> pred, </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">ref =</span> spam_test <span class="sc">|&gt;</span> <span class="fu">pull</span>(yesno))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   n   y
         n 516  77
         y  41 285
                                          
               Accuracy : 0.8716          
                 95% CI : (0.8482, 0.8926)
    No Information Rate : 0.6061          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.7263          
                                          
 Mcnemar's Test P-Value : 0.001273        
                                          
            Sensitivity : 0.9264          
            Specificity : 0.7873          
         Pos Pred Value : 0.8702          
         Neg Pred Value : 0.8742          
             Prevalence : 0.6061          
         Detection Rate : 0.5615          
   Detection Prevalence : 0.6453          
      Balanced Accuracy : 0.8568          
                                          
       'Positive' Class : n               
                                          </code></pre>
</div>
</div>
</section>
<section id="model-comparison" class="level2">
<h2 class="anchored" data-anchor-id="model-comparison"><strong>Model Comparison</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">createFolds</span>(spam_train<span class="sc">$</span>yesno, <span class="at">k =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Build models</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>rpartFit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">train</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make,</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> _,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"rpart"</span>,</span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">tuneLength =</span> <span class="dv">10</span>,</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">indexOut =</span> train_index)</span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>knnFit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> </span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">train</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> _,</span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">preProcess =</span> <span class="st">"scale"</span>,</span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">tuneLength =</span> <span class="dv">10</span>,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">indexOut =</span> train_index)</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compare accuracy over all folds.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>resamps <span class="ot">&lt;-</span> <span class="fu">resamples</span>(<span class="fu">list</span>(</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">CART =</span> rpartFit,</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">kNearestNeighbors =</span> knnFit</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(resamps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
summary.resamples(object = resamps)

Models: CART, kNearestNeighbors 
Number of resamples: 10 

Accuracy 
                       Min.   1st Qu.    Median      Mean   3rd Qu.      Max.
CART              0.8668478 0.8777174 0.8858696 0.8859329 0.8967391 0.9048913
kNearestNeighbors 0.8726287 0.8838315 0.8873829 0.8883808 0.8913043 0.9048913
                  NA's
CART                 0
kNearestNeighbors    0

Kappa 
                       Min.   1st Qu.    Median      Mean   3rd Qu.      Max.
CART              0.7153322 0.7366245 0.7547912 0.7560099 0.7808575 0.7966658
kNearestNeighbors 0.7267054 0.7511041 0.7596024 0.7611225 0.7684565 0.7966658
                  NA's
CART                 0
kNearestNeighbors    0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(resamps, <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above box plots provides a visual insights into the performance distribution of the models over multiple resampling iterations.We see that kNN is performing slightly better on the folds than CART (except for some outlier folds).</p>
<p>Finding out if one models is statistically better than the other (is the difference in accuracy is not zero).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>difs <span class="ot">&lt;-</span> <span class="fu">diff</span>(resamps)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>difs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
diff.resamples(x = resamps)

Models: CART, kNearestNeighbors 
Metrics: Accuracy, Kappa 
Number of differences: 1 
p-value adjustment: bonferroni </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(difs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
summary.diff.resamples(object = difs)

p-value adjustment: bonferroni 
Upper diagonal: estimates of the difference
Lower diagonal: p-value for H0: difference = 0

Accuracy 
                  CART   kNearestNeighbors
CART                     -0.002448        
kNearestNeighbors 0.5788                  

Kappa 
                  CART  kNearestNeighbors
CART                    -0.005113        
kNearestNeighbors 0.595                  </code></pre>
</div>
</div>
<p>The provided output summarizes a statistical comparison between CART and k-Nearest Neighbors models. K-Nearest Neighbors outperforms CART in accuracy and Kappa statistics, with statistically significant differences after Bonferroni correction, suggesting it’s a better model for the given data.</p>
</section>
<section id="feature-selection-and-feature-preparation" class="level2">
<h2 class="anchored" data-anchor-id="feature-selection-and-feature-preparation"><strong>Feature Selection and Feature Preparation</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FSelector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="univariate-feature-importance-score" class="level3">
<h3 class="anchored" data-anchor-id="univariate-feature-importance-score"><strong>Univariate Feature Importance Score</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chi.squared</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make, <span class="at">data =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"feature"</span>) <span class="sc">|&gt;</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(attr_importance))</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  feature attr_importance
  &lt;chr&gt;             &lt;dbl&gt;
1 bang              0.591
2 dollar            0.579
3 money             0.469
4 crl.tot           0.440
5 n000              0.425
6 make              0.265</code></pre>
</div>
</div>
<p>These scores measure how related each feature is to the class variable. For discrete features (as in our case), the chi-square statistic are used to derive the score.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(weights,</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> attr_importance, <span class="at">y =</span> <span class="fu">reorder</span>(feature, attr_importance))) <span class="sc">+</span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Importance score"</span>) <span class="sc">+</span> </span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Feature"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above plot is the importance in descending order (using <code>reorder</code> to order factor levels used by <code>ggplot</code>). we can see that bang is at the top followed by dollar, money, crl.tot, n000 and make at the last.</p>
<p>Getting the 5 best features</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>subset <span class="ot">&lt;-</span> <span class="fu">cutoff.k</span>(weights <span class="sc">|&gt;</span> </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">column_to_rownames</span>(<span class="st">"feature"</span>), <span class="dv">5</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>subset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "bang"    "dollar"  "money"   "crl.tot" "n000"   </code></pre>
</div>
</div>
<p>The above are the top 5 features of this dataset</p>
<p>Use only the best 5 features to build a model (<code>Fselector</code> provides <code>as.simple.formula</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">as.simple.formula</span>(subset, <span class="st">"yesno"</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>yesno ~ bang + dollar + money + crl.tot + n000
&lt;environment: 0x28a4118d8&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> <span class="fu">rpart</span>(f, <span class="at">data =</span> _)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(m, <span class="at">extra =</span> <span class="dv">2</span>, <span class="at">roundint =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above decision tree is built using FSelector and top 5 features obtained previously.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>spam_train <span class="sc">|&gt;</span> </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gain.ratio</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make, <span class="at">data =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"feature"</span>) <span class="sc">|&gt;</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(attr_importance))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  feature attr_importance
  &lt;chr&gt;             &lt;dbl&gt;
1 money            0.270 
2 n000             0.224 
3 dollar           0.206 
4 bang             0.159 
5 crl.tot          0.0715
6 make             0.0630</code></pre>
</div>
</div>
</section>
<section id="feature-subset-selection" class="level3">
<h3 class="anchored" data-anchor-id="feature-subset-selection"><strong>Feature Subset Selection</strong></h3>
<p>Often features are related and calculating importance for each feature independently is not optimal. We can use greedy search heuristics. For example <code>cfs</code> uses correlation/entropy with best first search.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>spam_train <span class="sc">|&gt;</span> </span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cfs</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make, <span class="at">data =</span> _)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "dollar" "bang"   "money"  "n000"  </code></pre>
</div>
</div>
<p>The above features are the result of The “cfs” method which performed feature selection based on correlations between variables and the target variable to identify relevant features.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>evaluator <span class="ot">&lt;-</span> <span class="cf">function</span>(subset) {</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> </span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">train</span>(<span class="fu">as.simple.formula</span>(subset, <span class="st">"type"</span>),</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> _,</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> <span class="st">"rpart"</span>,</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"boot"</span>, <span class="at">number =</span> <span class="dv">5</span>),</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">tuneLength =</span> <span class="dv">0</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> model<span class="sc">$</span>resample<span class="sc">$</span>Accuracy</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Trying features:"</span>, <span class="fu">paste</span>(subset, <span class="at">collapse =</span> <span class="st">" + "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">mean</span>(results)</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Accuracy:"</span>, <span class="fu">round</span>(m, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>  m</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Overall, this function is used to evaluate the accuracy of a decision tree model (CART) using different subsets of features. It prints the accuracy for each subset and returns the mean accuracy as a measure of model performance.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Start with all features</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> <span class="fu">colnames</span>() <span class="sc">|&gt;</span> <span class="fu">setdiff</span>(<span class="st">"yesno"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="using-dummy-variables-for-factors" class="level3">
<h3 class="anchored" data-anchor-id="using-dummy-variables-for-factors"><strong>Using Dummy Variables for Factors</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>tree_bang <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpart</span>(bang <span class="sc">~</span> yesno, <span class="at">data =</span> _)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree_bang, <span class="at">roundint =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above tree tell us that for a given bang value, the percentage of it being classified as spam is 61.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>Zoo_train_dummy <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">class2ind</span>(spam_train<span class="sc">$</span>yesno)) <span class="sc">|&gt;</span> </span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.factor)) <span class="sc">|&gt;</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">bang =</span> spam_train<span class="sc">$</span>bang)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>Zoo_train_dummy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,682 × 3
   n     y      bang
   &lt;fct&gt; &lt;fct&gt; &lt;dbl&gt;
 1 0     1     0.778
 2 0     1     0.372
 3 0     1     0.276
 4 0     1     0.137
 5 0     1     0.135
 6 0     1     0    
 7 0     1     0.164
 8 0     1     0    
 9 0     1     0.244
10 0     1     0.462
# ℹ 3,672 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>tree_bang <span class="ot">&lt;-</span> Zoo_train_dummy <span class="sc">|&gt;</span> </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpart</span>(bang <span class="sc">~</span> ., </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> _,</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">minsplit =</span> <span class="dv">2</span>, <span class="at">cp =</span> <span class="fl">0.01</span>))</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree_bang, <span class="at">roundint =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">train</span>(bang <span class="sc">~</span> yesno, </span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> _, </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"rpart"</span>,</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">minsplit =</span> <span class="dv">2</span>),</span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">cp =</span> <span class="fl">0.01</span>))</span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CART 

3682 samples
   1 predictor

No pre-processing
Resampling: Bootstrapped (25 reps) 
Summary of sample sizes: 3682, 3682, 3682, 3682, 3682, 3682, ... 
Resampling results:

  RMSE       Rsquared   MAE    
  0.9235146  0.0500027  0.28585

Tuning parameter 'cp' was held constant at a value of 0.01</code></pre>
</div>
</div>
<p>The above information describes a CART (Classification and Regression Trees) model. It is trained on 3682 samples with one predictor, without pre-processing. The model’s performance was evaluated using bootstrapped resampling with 25 repetitions. The results show root mean squared error (RMSE) of 0.849, R-squared of 0.0637, and mean absolute error (MAE) of 0.287. The tuning parameter ‘cp’ was fixed at 0.01, indicating no hyperparameter tuning is performed.</p>
</section>
</section>
<section id="class-imbalance" class="level2">
<h2 class="anchored" data-anchor-id="class-imbalance"><strong>Class Imbalance</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spam, <span class="fu">aes</span>(<span class="at">y =</span> yesno)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There is not a significant imbalance with the number of records classified as yes and no. There isn’t any other features which are nominal which can be used to classfiy whether it is spam or not. Thus this exercise isn’t applicable to this dataset.</p>
</section>
</section>
<section id="classification-alternative-techniques" class="level1">
<h1><strong>Classification: Alternative Techniques</strong></h1>
<section id="install-packages-1" class="level2">
<h2 class="anchored" data-anchor-id="install-packages-1"><strong>Install packages</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(pacman))</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(</span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>  C50,                <span class="co"># C5.0 Decision Trees and Rule-Based Models</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  caret,              <span class="co"># Classification and Regression Training</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  e1071,              <span class="co"># Misc Functions of the Department of Statistics (e1071), TU Wien</span></span>
<span id="cb89-8"><a href="#cb89-8" aria-hidden="true" tabindex="-1"></a>  keras,              <span class="co"># R Interface to 'Keras'</span></span>
<span id="cb89-9"><a href="#cb89-9" aria-hidden="true" tabindex="-1"></a>  kernlab,            <span class="co"># Kernel-Based Machine Learning Lab</span></span>
<span id="cb89-10"><a href="#cb89-10" aria-hidden="true" tabindex="-1"></a>  lattice,            <span class="co"># Trellis Graphics for R</span></span>
<span id="cb89-11"><a href="#cb89-11" aria-hidden="true" tabindex="-1"></a>  MASS,               <span class="co"># Support Functions and Datasets for Venables and Ripley's MASS</span></span>
<span id="cb89-12"><a href="#cb89-12" aria-hidden="true" tabindex="-1"></a>  mlbench,            <span class="co"># Machine Learning Benchmark Problems</span></span>
<span id="cb89-13"><a href="#cb89-13" aria-hidden="true" tabindex="-1"></a>  nnet,               <span class="co"># Feedforward Neural Networks and Multinomial Log-Linear Models</span></span>
<span id="cb89-14"><a href="#cb89-14" aria-hidden="true" tabindex="-1"></a>  palmerpenguins,     <span class="co"># Palmer Archipelago (Antarctica) Penguin Data</span></span>
<span id="cb89-15"><a href="#cb89-15" aria-hidden="true" tabindex="-1"></a>  party,              <span class="co"># A Laboratory for Recursive Partytioning</span></span>
<span id="cb89-16"><a href="#cb89-16" aria-hidden="true" tabindex="-1"></a>  partykit,           <span class="co"># A Toolkit for Recursive Partytioning</span></span>
<span id="cb89-17"><a href="#cb89-17" aria-hidden="true" tabindex="-1"></a>  randomForest,       <span class="co"># Breiman and Cutler's Random Forests for Classification and Regression</span></span>
<span id="cb89-18"><a href="#cb89-18" aria-hidden="true" tabindex="-1"></a>  rpart,              <span class="co"># Recursive partitioning models</span></span>
<span id="cb89-19"><a href="#cb89-19" aria-hidden="true" tabindex="-1"></a>  RWeka,              <span class="co"># R/Weka Interface</span></span>
<span id="cb89-20"><a href="#cb89-20" aria-hidden="true" tabindex="-1"></a>  scales,             <span class="co"># Scale Functions for Visualization</span></span>
<span id="cb89-21"><a href="#cb89-21" aria-hidden="true" tabindex="-1"></a>  tidymodels,         <span class="co"># Tidy machine learning framework</span></span>
<span id="cb89-22"><a href="#cb89-22" aria-hidden="true" tabindex="-1"></a>  tidyverse,          <span class="co"># Tidy data wrangling and visualization</span></span>
<span id="cb89-23"><a href="#cb89-23" aria-hidden="true" tabindex="-1"></a>  xgboost             <span class="co"># Extreme Gradient Boosting</span></span>
<span id="cb89-24"><a href="#cb89-24" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="training-and-test-data" class="level2">
<h2 class="anchored" data-anchor-id="training-and-test-data"><strong>Training and Test Data</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># for reproducibility</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>inTrain <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(<span class="at">y =</span> spam<span class="sc">$</span>yesno, <span class="at">p =</span> .<span class="dv">8</span>)[[<span class="dv">1</span>]]</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>spam_train <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">slice</span>(spam, inTrain)</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>spam_test <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">slice</span>(spam, <span class="sc">-</span>inTrain)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="co">#For alternative techniques, we are diviing the dataset into spam_train and spam_test, which are the training and testing sets resp. They are divided in the ratio 80:20.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fitting-different-classification-models-to-the-training-data" class="level2">
<h2 class="anchored" data-anchor-id="fitting-different-classification-models-to-the-training-data"><strong>Fitting Different Classification Models to the Training Data</strong></h2>
<p>Creating a fixed sampling scheme (10-folds) so we can compare the fitted models later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">createFolds</span>(spam_train<span class="sc">$</span>yesno, <span class="at">k =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="conditional-inference-tree-decision-tree" class="level3">
<h3 class="anchored" data-anchor-id="conditional-inference-tree-decision-tree"><strong>Conditional Inference Tree (Decision Tree)</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>ctreeFit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> <span class="fu">train</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make,</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"ctree"</span>,</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> _,</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">5</span>,</span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">indexOut =</span> train_index))</span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a>ctreeFit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Conditional Inference Tree 

3682 samples
   6 predictor
   2 classes: 'n', 'y' 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 3313, 3314, 3314, 3314, 3314, 3314, ... 
Resampling results across tuning parameters:

  mincriterion  Accuracy  Kappa
  0.010         0.888     0.758
  0.255         0.882     0.744
  0.500         0.879     0.737
  0.745         0.878     0.734
  0.990         0.871     0.722

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was mincriterion = 0.01.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The ctreeFit object will contain the results of training a conditional inference tree model using the specified dataset and parameters. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In the Conditional Inference Tree model, trained on 3682 samples with 6 predictors and 2 classes (‘n’ and ‘y’), without pre-processing, 10-fold cross-validated resampling was performed, with varying levels of the “mincriterion” tuning parameter (ranging from 0.01 to 0.99). The model’s performance was evaluated, and the optimal model with the highest accuracy (0.888) and Kappa (0.758) was selected, where the final “mincriterion” value was set at 0.01.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ctreeFit<span class="sc">$</span>finalModel)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above is the output of the best model of conditional Inference Tree model, These trees are constructed in a way that optimizes for accuracy and may create a detailed tree structure to capture intricate relationships in the data. As a result, when we try to visualize the tree, especially for this dataset with multiple predictors, it appears complex and contains multiple branches and nodes.</p>
</section>
<section id="c-4.5-decision-tree" class="level3">
<h3 class="anchored" data-anchor-id="c-4.5-decision-tree"><strong>C 4.5 Decision Tree</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>C45Fit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> <span class="fu">train</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make,</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"J48"</span>,</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> _,</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">5</span>,</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">indexOut =</span> train_index))</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>C45Fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>C4.5-like Trees 

3682 samples
   6 predictor
   2 classes: 'n', 'y' 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 3314, 3314, 3314, 3314, 3314, 3313, ... 
Resampling results across tuning parameters:

  C      M  Accuracy  Kappa
  0.010  1  0.883     0.750
  0.010  2  0.883     0.750
  0.010  3  0.882     0.746
  0.010  4  0.881     0.744
  0.010  5  0.881     0.744
  0.133  1  0.889     0.760
  0.133  2  0.888     0.759
  0.133  3  0.887     0.757
  0.133  4  0.885     0.752
  0.133  5  0.884     0.750
  0.255  1  0.890     0.762
  0.255  2  0.889     0.761
  0.255  3  0.888     0.758
  0.255  4  0.885     0.752
  0.255  5  0.885     0.751
  0.378  1  0.891     0.765
  0.378  2  0.891     0.764
  0.378  3  0.889     0.760
  0.378  4  0.885     0.751
  0.378  5  0.886     0.754
  0.500  1  0.891     0.765
  0.500  2  0.891     0.764
  0.500  3  0.889     0.761
  0.500  4  0.887     0.755
  0.500  5  0.887     0.756

Accuracy was used to select the optimal model using the largest value.
The final values used for the model were C = 0.378 and M = 1.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The C45Fit object will contain the results of training a C4.5 decision tree model using the specified dataset and parameters. </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this analysis using C4.5-like decision trees, trained on 3682 samples with 6 predictors and 2 classes (‘n’ and ‘y’), no data pre-processing was performed. Cross-validated (10-fold) resampling was used to evaluate the model’s performance across different combinations of tuning parameters (C and M). The highest accuracy (0.891) and Kappa (0.765) were achieved with specific parameter values: C = 0.378 and M = 1, indicating this as the optimal model configuration.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>C45Fit<span class="sc">$</span>finalModel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>J48 pruned tree
------------------

dollar &lt;= 0.055
|   money &lt;= 0
|   |   bang &lt;= 0.169
|   |   |   n000 &lt;= 0.11
|   |   |   |   bang &lt;= 0.028: n (1725.0/137.0)
|   |   |   |   bang &gt; 0.028
|   |   |   |   |   dollar &lt;= 0.005: n (256.0/49.0)
|   |   |   |   |   dollar &gt; 0.005
|   |   |   |   |   |   n000 &lt;= 0.04
|   |   |   |   |   |   |   crl.tot &lt;= 819
|   |   |   |   |   |   |   |   dollar &lt;= 0.039: n (6.0)
|   |   |   |   |   |   |   |   dollar &gt; 0.039
|   |   |   |   |   |   |   |   |   make &lt;= 0.11: n (13.0/5.0)
|   |   |   |   |   |   |   |   |   make &gt; 0.11: y (4.0)
|   |   |   |   |   |   |   crl.tot &gt; 819: y (6.0/1.0)
|   |   |   |   |   |   n000 &gt; 0.04: n (3.0)
|   |   |   n000 &gt; 0.11
|   |   |   |   crl.tot &lt;= 205
|   |   |   |   |   make &lt;= 0.45: y (13.0/2.0)
|   |   |   |   |   make &gt; 0.45: n (2.0)
|   |   |   |   crl.tot &gt; 205
|   |   |   |   |   crl.tot &lt;= 1738: n (12.0/1.0)
|   |   |   |   |   crl.tot &gt; 1738: y (2.0)
|   |   bang &gt; 0.169
|   |   |   crl.tot &lt;= 68
|   |   |   |   bang &lt;= 0.757: n (202.0/43.0)
|   |   |   |   bang &gt; 0.757
|   |   |   |   |   crl.tot &lt;= 22
|   |   |   |   |   |   bang &lt;= 3.907: n (32.0/5.0)
|   |   |   |   |   |   bang &gt; 3.907
|   |   |   |   |   |   |   bang &lt;= 7.707: y (5.0)
|   |   |   |   |   |   |   bang &gt; 7.707: n (2.0)
|   |   |   |   |   crl.tot &gt; 22
|   |   |   |   |   |   bang &lt;= 4.347: y (36.0/6.0)
|   |   |   |   |   |   bang &gt; 4.347: n (4.0)
|   |   |   crl.tot &gt; 68
|   |   |   |   bang &lt;= 0.563
|   |   |   |   |   crl.tot &lt;= 179
|   |   |   |   |   |   n000 &lt;= 0.15: n (91.0/40.0)
|   |   |   |   |   |   n000 &gt; 0.15: y (5.0/1.0)
|   |   |   |   |   crl.tot &gt; 179: y (71.0/10.0)
|   |   |   |   bang &gt; 0.563: y (124.0/3.0)
|   money &gt; 0
|   |   bang &lt;= 0.081
|   |   |   n000 &lt;= 0.3
|   |   |   |   dollar &lt;= 0.024
|   |   |   |   |   dollar &lt;= 0.019
|   |   |   |   |   |   money &lt;= 1.32
|   |   |   |   |   |   |   crl.tot &lt;= 5902: n (17.0/1.0)
|   |   |   |   |   |   |   crl.tot &gt; 5902: y (2.0)
|   |   |   |   |   |   money &gt; 1.32
|   |   |   |   |   |   |   crl.tot &lt;= 54: n (7.0/2.0)
|   |   |   |   |   |   |   crl.tot &gt; 54: y (6.0)
|   |   |   |   |   dollar &gt; 0.019: y (2.0)
|   |   |   |   dollar &gt; 0.024: n (6.0)
|   |   |   n000 &gt; 0.3: y (4.0)
|   |   bang &gt; 0.081
|   |   |   crl.tot &lt;= 87
|   |   |   |   crl.tot &lt;= 74
|   |   |   |   |   money &lt;= 0.63
|   |   |   |   |   |   make &lt;= 0.11: n (2.0)
|   |   |   |   |   |   make &gt; 0.11: y (1.0)
|   |   |   |   |   money &gt; 0.63: y (10.0)
|   |   |   |   crl.tot &gt; 74: n (4.0)
|   |   |   crl.tot &gt; 87: y (95.0/1.0)
dollar &gt; 0.055
|   bang &lt;= 0.143
|   |   money &lt;= 0.02
|   |   |   n000 &lt;= 0.49
|   |   |   |   dollar &lt;= 0.168
|   |   |   |   |   bang &lt;= 0.049: n (53.0/8.0)
|   |   |   |   |   bang &gt; 0.049
|   |   |   |   |   |   bang &lt;= 0.07: y (10.0)
|   |   |   |   |   |   bang &gt; 0.07
|   |   |   |   |   |   |   crl.tot &lt;= 126: y (3.0)
|   |   |   |   |   |   |   crl.tot &gt; 126: n (12.0/2.0)
|   |   |   |   dollar &gt; 0.168
|   |   |   |   |   dollar &lt;= 0.188: y (12.0)
|   |   |   |   |   dollar &gt; 0.188
|   |   |   |   |   |   n000 &lt;= 0.1: n (45.0/20.0)
|   |   |   |   |   |   n000 &gt; 0.1
|   |   |   |   |   |   |   dollar &lt;= 0.291: n (1.0)
|   |   |   |   |   |   |   dollar &gt; 0.291: y (3.0)
|   |   |   n000 &gt; 0.49: y (33.0)
|   |   money &gt; 0.02
|   |   |   crl.tot &lt;= 53
|   |   |   |   crl.tot &lt;= 50: n (3.0)
|   |   |   |   crl.tot &gt; 50: y (7.0)
|   |   |   crl.tot &gt; 53: y (113.0/2.0)
|   bang &gt; 0.143
|   |   crl.tot &lt;= 418
|   |   |   bang &lt;= 0.376
|   |   |   |   bang &lt;= 0.26: y (75.0/3.0)
|   |   |   |   bang &gt; 0.26
|   |   |   |   |   make &lt;= 0.27
|   |   |   |   |   |   make &lt;= 0.08
|   |   |   |   |   |   |   dollar &lt;= 0.165
|   |   |   |   |   |   |   |   dollar &lt;= 0.104
|   |   |   |   |   |   |   |   |   money &lt;= 0.19
|   |   |   |   |   |   |   |   |   |   crl.tot &lt;= 62: n (2.0)
|   |   |   |   |   |   |   |   |   |   crl.tot &gt; 62: y (7.0)
|   |   |   |   |   |   |   |   |   money &gt; 0.19: n (1.0)
|   |   |   |   |   |   |   |   dollar &gt; 0.104: y (15.0)
|   |   |   |   |   |   |   dollar &gt; 0.165
|   |   |   |   |   |   |   |   dollar &lt;= 0.466
|   |   |   |   |   |   |   |   |   crl.tot &lt;= 102: n (7.0)
|   |   |   |   |   |   |   |   |   crl.tot &gt; 102
|   |   |   |   |   |   |   |   |   |   crl.tot &lt;= 226: y (4.0)
|   |   |   |   |   |   |   |   |   |   crl.tot &gt; 226: n (2.0)
|   |   |   |   |   |   |   |   dollar &gt; 0.466: y (3.0)
|   |   |   |   |   |   make &gt; 0.08
|   |   |   |   |   |   |   dollar &lt;= 0.46: n (2.0)
|   |   |   |   |   |   |   dollar &gt; 0.46: y (1.0)
|   |   |   |   |   make &gt; 0.27: y (10.0)
|   |   |   bang &gt; 0.376: y (206.0/3.0)
|   |   crl.tot &gt; 418: y (282.0)

Number of Leaves  :     59

Size of the tree :  117</code></pre>
</div>
</div>
<p>The tree provides a set of decision rules based on predictor variables such as ‘dollar,’ ‘money,’ ‘bang,’ ‘n000,’ ‘crl.tot,’ and ‘make,’ allowing for the classification of data points into either ‘n’ or ‘y’ based on these rules, with specific conditions and branches defined for each predictor.</p>
</section>
<section id="k-nearest-neighbors" class="level3">
<h3 class="anchored" data-anchor-id="k-nearest-neighbors"><strong>K-Nearest Neighbors</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>knnFit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> <span class="fu">train</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make,</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> _,</span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">preProcess =</span> <span class="st">"scale"</span>,</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">5</span>,</span>
<span id="cb102-6"><a href="#cb102-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneGrid=</span><span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>),</span>
<span id="cb102-7"><a href="#cb102-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">indexOut =</span> train_index))</span>
<span id="cb102-8"><a href="#cb102-8" aria-hidden="true" tabindex="-1"></a>knnFit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>k-Nearest Neighbors 

3682 samples
   6 predictor
   2 classes: 'n', 'y' 

Pre-processing: scaled (6) 
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 3314, 3314, 3314, 3314, 3314, 3314, ... 
Resampling results across tuning parameters:

  k   Accuracy  Kappa
   1  0.963     0.921
   2  0.913     0.816
   3  0.906     0.800
   4  0.890     0.765
   5  0.889     0.763
   6  0.886     0.756
   7  0.880     0.744
   8  0.876     0.733
   9  0.878     0.738
  10  0.875     0.730

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was k = 1.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The knnFit object will contain the results of training a KNN classification model using the specified dataset, preprocessing (scaling), and parameters.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>This analysis employed a k-Nearest Neighbors (k-NN) classification model with 3682 samples, 6 predictors, and 2 classes (‘n’ and ‘y’). The data underwent scaling as a preprocessing step. The model’s performance was assessed through 10-fold cross-validation, varying the number of neighbors (k) from 1 to 10. The optimal model configuration was chosen based on accuracy, favoring k=1, which yielded the highest accuracy of 96.3% and a Kappa statistic of 0.921.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>knnFit<span class="sc">$</span>finalModel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1-nearest neighbor model
Training set outcome distribution:

   n    y 
2231 1451 </code></pre>
</div>
</div>
<p>The above is the classification done by the best model of knn classifier using the spam training dataset.</p>
</section>
<section id="part-rule-based-classifier" class="level3">
<h3 class="anchored" data-anchor-id="part-rule-based-classifier"><strong>PART (Rule-based classifier)</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>rulesFit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> <span class="fu">train</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make,</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"PART"</span>,</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> _,</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">5</span>,</span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">indexOut =</span> train_index))</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>rulesFit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rule-Based Classifier 

3682 samples
   6 predictor
   2 classes: 'n', 'y' 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 3314, 3314, 3314, 3314, 3313, 3314, ... 
Resampling results across tuning parameters:

  threshold  pruned  Accuracy  Kappa
  0.010      yes     0.883     0.748
  0.010      no      0.877     0.734
  0.133      yes     0.886     0.756
  0.133      no      0.877     0.734
  0.255      yes     0.884     0.750
  0.255      no      0.877     0.734
  0.378      yes     0.883     0.749
  0.378      no      0.877     0.734
  0.500      yes     0.883     0.749
  0.500      no      0.877     0.734

Accuracy was used to select the optimal model using the largest value.
The final values used for the model were threshold = 0.133 and pruned = yes.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="co">#The rulesFit object will contain the results of training a rule-based classification model using the specified dataset and parameters.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this analysis, a Rule-Based Classifier was applied to a dataset with 3682 samples, 6 predictors, and 2 classes (‘n’ and ‘y’). No pre-processing was performed, and the model’s performance was evaluated through 10-fold cross-validation while varying tuning parameters: ‘threshold’ and ‘pruned’. The optimal model configuration was determined based on accuracy, favoring a ‘threshold’ of 0.133 and ‘pruned’ setting as ‘yes,’ resulting in the highest accuracy of 88.6% and a Kappa statistic of 0.756.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>rulesFit<span class="sc">$</span>finalModel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>PART decision list
------------------

dollar &gt; 0.055 AND
bang &gt; 0.143 AND
crl.tot &gt; 418: y (282.0)

dollar &gt; 0.055 AND
bang &gt; 0.049: y (438.0/36.0)

money &gt; 0 AND
n000 &lt;= 0.25 AND
money &gt; 0.16 AND
crl.tot &gt; 93: y (111.0/7.0)

n000 &gt; 0.25 AND
bang &gt; 0.003: y (82.0/2.0)

bang &lt;= 0.171 AND
dollar &lt;= 0.168 AND
crl.tot &gt; 15 AND
n000 &lt;= 0.16 AND
money &lt;= 0.03 AND
bang &lt;= 0.027: n (1313.0/136.0)

crl.tot &lt;= 15 AND
bang &lt;= 0.613: n (476.0/11.0)

bang &gt; 0.486 AND
crl.tot &gt; 64 AND
make &lt;= 0.11: y (136.0/8.0)

money &gt; 0.87 AND
money &lt;= 1.47: y (19.0)

n000 &gt; 0.27 AND
make &lt;= 0.18 AND
n000 &gt; 0.42: y (17.0)

bang &lt;= 0.188 AND
dollar &lt;= 0.005: n (311.0/64.0)

crl.tot &lt;= 51 AND
bang &lt;= 0.53 AND
dollar &lt;= 0.279: n (105.0/18.0)

crl.tot &lt;= 22 AND
bang &lt;= 3.907: n (57.0/10.0)

n000 &gt; 0.06 AND
crl.tot &gt; 246 AND
dollar &gt; 0.036: n (11.0)

money &gt; 0 AND
n000 &lt;= 0.24 AND
crl.tot &lt;= 368: y (10.0/2.0)

: y (314.0/142.0)

Number of Rules  :  15</code></pre>
</div>
</div>
<p>The provided information represents a decision list generated by a PART (Partial C 4.5) algorithm. The list contains 15 rules used for classifying instances into two classes (‘n’ and ‘y’). Each rule specifies a combination of conditions involving predictor variables such as ‘dollar,’ ‘bang,’ ‘crl.tot,’ ‘n000,’ ‘money,’ and ‘make.’ For each rule, it indicates the predicted class and the associated class distribution. This decision list is used for classification, and the algorithm selects the rule that best matches each instance to make predictions.</p>
</section>
<section id="linear-support-vector-machines" class="level3">
<h3 class="anchored" data-anchor-id="linear-support-vector-machines"><strong>Linear Support Vector Machines</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>svmFit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> <span class="fu">train</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make,</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"svmLinear"</span>,</span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> _,</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">5</span>,</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">indexOut =</span> train_index))</span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a>svmFit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Support Vector Machines with Linear Kernel 

3682 samples
   6 predictor
   2 classes: 'n', 'y' 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 3314, 3314, 3314, 3314, 3314, 3313, ... 
Resampling results:

  Accuracy  Kappa
  0.845     0.663

Tuning parameter 'C' was held constant at a value of 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The svmFit object will contain the results of training a linear SVM classification model using the specified dataset and parameters.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this analysis, a Support Vector Machine (SVM) with a linear kernel was employed on a dataset containing 3682 samples with 6 predictors and 2 classes (‘n’ and ‘y’). No pre-processing was applied, and the model’s performance was evaluated using 10-fold cross-validation. The SVM achieved an accuracy of 84.5% and a Kappa coefficient of 0.663. The tuning parameter ‘C’ was kept constant at a value of 1, indicating that regularization strength did not vary during model training.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>svmFit<span class="sc">$</span>finalModel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Support Vector Machine object of class "ksvm" 

SV type: C-svc  (classification) 
 parameter : cost C = 1 

Linear (vanilla) kernel function. 

Number of Support Vectors : 1516 

Objective Function Value : -1509 
Training error : 0.156437 </code></pre>
</div>
</div>
<p>The provided information describes a Support Vector Machine (SVM) model with a C-support vector classification (C-svc) objective, indicating it’s designed for classification tasks. The model employs a linear kernel function, and the parameter ‘cost C’ is set to 1, reflecting the regularization strength. The model was trained with a dataset, and it identified 1516 support vectors, which are crucial data points for defining the decision boundary. The objective function value is -1509, and the training error rate is 15.64%, indicating the model’s performance on the training data.</p>
</section>
<section id="random-forest" class="level3">
<h3 class="anchored" data-anchor-id="random-forest"><strong>Random Forest</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>randomForestFit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> <span class="fu">train</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make,</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"rf"</span>,</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> _,</span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">5</span>,</span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">indexOut =</span> train_index))</span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a>randomForestFit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Random Forest 

3682 samples
   6 predictor
   2 classes: 'n', 'y' 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 3313, 3314, 3314, 3314, 3313, 3314, ... 
Resampling results across tuning parameters:

  mtry  Accuracy  Kappa
  2     0.922     0.832
  3     0.943     0.878
  4     0.958     0.910
  5     0.962     0.919
  6     0.964     0.923

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was mtry = 6.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The randomForestFit object will contain the results of training a Random Forest classification model using the specified dataset and parameters.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>In this analysis, a Random Forest model was applied to a dataset with 3682 samples, 6 predictors, and 2 classes (‘n’ and ‘y’). No pre-processing was performed. The model’s performance was assessed using 10-fold cross-validation, with varying ‘mtry’ values, representing the number of predictors considered at each split. The optimal model configuration was determined based on accuracy, favoring ‘mtry’ set to 6, which yielded the highest accuracy of 96.4% and a Kappa statistic of 0.923, signifying excellent classification performance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>randomForestFit<span class="sc">$</span>finalModel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
 randomForest(x = x, y = y, mtry = param$mtry) 
               Type of random forest: classification
                     Number of trees: 500
No. of variables tried at each split: 6

        OOB estimate of  error rate: 12.5%
Confusion matrix:
     n    y class.error
n 2050  181      0.0811
y  279 1172      0.1923</code></pre>
</div>
</div>
<p>The output is from a Random Forest classification model with 500 trees and 6 predictors randomly selected for consideration at each split. Out-of-bag (OOB) estimation indicates an error rate of 12.5%. The confusion matrix shows that among the ‘n’ class, 2050 samples were correctly classified, 181 were misclassified, resulting in a class error of 8.11%. For the ‘y’ class, 1172 were correctly classified, 279 were misclassified, with a class error of 19.23%.</p>
</section>
<section id="gradient-boosted-decision-trees-xgboost" class="level3">
<h3 class="anchored" data-anchor-id="gradient-boosted-decision-trees-xgboost"><strong>Gradient Boosted Decision Trees (xgboost)</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>xgboostFit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> <span class="fu">train</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make,</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"xgbTree"</span>,</span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> _,</span>
<span id="cb122-4"><a href="#cb122-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneLength =</span> <span class="dv">5</span>,</span>
<span id="cb122-5"><a href="#cb122-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">indexOut =</span> train_index),</span>
<span id="cb122-6"><a href="#cb122-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">tuneGrid =</span> <span class="fu">expand.grid</span>(</span>
<span id="cb122-7"><a href="#cb122-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrounds =</span> <span class="dv">20</span>,</span>
<span id="cb122-8"><a href="#cb122-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">max_depth =</span> <span class="dv">3</span>,</span>
<span id="cb122-9"><a href="#cb122-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">colsample_bytree =</span> .<span class="dv">6</span>,</span>
<span id="cb122-10"><a href="#cb122-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">eta =</span> <span class="fl">0.1</span>,</span>
<span id="cb122-11"><a href="#cb122-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">gamma=</span><span class="dv">0</span>,</span>
<span id="cb122-12"><a href="#cb122-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">min_child_weight =</span> <span class="dv">1</span>,</span>
<span id="cb122-13"><a href="#cb122-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subsample =</span> .<span class="dv">5</span></span>
<span id="cb122-14"><a href="#cb122-14" aria-hidden="true" tabindex="-1"></a>  ))</span>
<span id="cb122-15"><a href="#cb122-15" aria-hidden="true" tabindex="-1"></a>xgboostFit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>eXtreme Gradient Boosting 

3682 samples
   6 predictor
   2 classes: 'n', 'y' 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 3314, 3313, 3314, 3314, 3314, 3314, ... 
Resampling results:

  Accuracy  Kappa
  0.869     0.716

Tuning parameter 'nrounds' was held constant at a value of 20
Tuning
 held constant at a value of 1
Tuning parameter 'subsample' was held
 constant at a value of 0.5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a classification model using XGBoost with hyperparameter tuning. It uses the "xgbTree" method, applies cross-validation, and explores different hyperparameter combinations. The tuning grid includes parameters like the number of boosting rounds, tree depth, and subsampling rate. xgboostFit contains the model with the optimal parameter configuration.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The information pertains to an eXtreme Gradient Boosting (XGBoost) model applied to a dataset with 3682 samples, 6 predictors, and 2 classes (‘n’ and ‘y’). No pre-processing was performed. The model’s performance was assessed using 10-fold cross-validation, resulting in an accuracy of 86.9% and a Kappa statistic of 0.716. Several tuning parameters were held constant, including ‘nrounds,’ ‘max_depth,’ ‘eta,’ ‘gamma,’ ‘colsample_bytree,’ ‘min_child_weight,’ and ‘subsample,’ indicating that the model’s hyperparameters were not varied during the tuning process.<br>
<br>
</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>xgboostFit<span class="sc">$</span>finalModel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>##### xgb.Booster
raw: 26.3 Kb 
call:
  xgboost::xgb.train(params = list(eta = param$eta, max_depth = param$max_depth, 
    gamma = param$gamma, colsample_bytree = param$colsample_bytree, 
    min_child_weight = param$min_child_weight, subsample = param$subsample), 
    data = x, nrounds = param$nrounds, objective = "binary:logistic")
params (as set within xgb.train):
  eta = "0.1", max_depth = "3", gamma = "0", colsample_bytree = "0.6", min_child_weight = "1", subsample = "0.5", objective = "binary:logistic", validate_parameters = "TRUE"
xgb.attributes:
  niter
callbacks:
  cb.print.evaluation(period = print_every_n)
# of features: 6 
niter: 20
nfeatures : 6 
xNames : crl.tot dollar bang money n000 make 
problemType : Classification 
tuneValue :
      nrounds max_depth eta gamma colsample_bytree min_child_weight subsample
1      20         3 0.1     0              0.6                1       0.5
obsLevels : n y 
param :
    list()</code></pre>
</div>
</div>
<p>The output shows the configuration of hyperparameters for an eXtreme Gradient Boosting (XGBoost) model, including 20 boosting rounds, a maximum tree depth of 3, a learning rate of 0.1, no minimum loss reduction requirement for partitioning nodes, a 60% random sampling of features during tree growth, a minimum child weight of 1, and a 50% subsample of the training data for each boosting round. These parameters significantly influence the model’s behavior and performance.</p>
</section>
<section id="artificial-neural-network" class="level3">
<h3 class="anchored" data-anchor-id="artificial-neural-network"><strong>Artificial Neural Network</strong></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>nnetFit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> <span class="fu">train</span>(yesno <span class="sc">~</span> crl.tot<span class="sc">+</span>dollar<span class="sc">+</span>bang<span class="sc">+</span>money<span class="sc">+</span>n000<span class="sc">+</span>make,</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">method =</span> <span class="st">"nnet"</span>,</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> _,</span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">5</span>,</span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">indexOut =</span> train_index),</span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>nnetFit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neural Network 

3682 samples
   6 predictor
   2 classes: 'n', 'y' 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 3314, 3314, 3314, 3314, 3314, 3313, ... 
Resampling results across tuning parameters:

  size  decay  Accuracy  Kappa
  1     0e+00  0.810     0.564
  1     1e-04  0.781     0.486
  1     1e-03  0.857     0.697
  1     1e-02  0.834     0.631
  1     1e-01  0.833     0.628
  3     0e+00  0.872     0.727
  3     1e-04  0.869     0.720
  3     1e-03  0.877     0.737
  3     1e-02  0.875     0.732
  3     1e-01  0.875     0.731
  5     0e+00  0.878     0.738
  5     1e-04  0.878     0.738
  5     1e-03  0.851     0.666
  5     1e-02  0.877     0.736
  5     1e-01  0.878     0.739
  7     0e+00  0.875     0.731
  7     1e-04  0.875     0.733
  7     1e-03  0.877     0.736
  7     1e-02  0.877     0.736
  7     1e-01  0.879     0.740
  9     0e+00  0.876     0.735
  9     1e-04  0.878     0.740
  9     1e-03  0.879     0.740
  9     1e-02  0.877     0.735
  9     1e-01  0.878     0.737

Accuracy was used to select the optimal model using the largest value.
The final values used for the model were size = 7 and decay = 0.1.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we train a neural network (nnet) classification model using the caret package. It employs cross-validation for evaluation and hyperparameter tuning. The nnetFit object stores the results, including the best neural network model configuration determined during hyperparameter tuning.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><br>
The results are of thea bove mentioned neural network model. It was tested on 3682 samples with 6 predictor variables and aimed at binary classification (‘n’ or ‘y’). The model went through 10-fold cross-validation, with varying combinations of two key hyperparameters: ‘size’ and ‘decay.’ The optimal configuration, chosen for its highest accuracy, had ‘size’ set to 7 and ‘decay’ at 0.1, resulting in an accuracy of 87.9% and a Kappa value of 0.74. These parameters determine the architecture and learning rate of the neural network and significantly impact its predictive performance.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>nnetFit<span class="sc">$</span>finalModel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>a 6-7-1 network with 57 weights
inputs: crl.tot dollar bang money n000 make 
output(s): .outcome 
options were - entropy fitting  decay=0.1</code></pre>
</div>
</div>
<p>The described neural network is a 6-7-1 architecture with 57 weights. It takes six input features (crl.tot, dollar, bang, money, n000, make) and produces one output labeled “.outcome.” It uses entropy-based fitting and has a learning rate decay of 0.1. The 57 weights are crucial for learning and predicting outcomes. This network is tailored for a specific classification task and aims to capture complex patterns in the data to make accurate predictions.</p>
</section>
</section>
<section id="comparing-models" class="level2">
<h2 class="anchored" data-anchor-id="comparing-models"><strong>Comparing Models</strong></h2>
<p>Collect the performance metrics from the models trained on the same data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>resamps <span class="ot">&lt;-</span> <span class="fu">resamples</span>(<span class="fu">list</span>(</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">ctree =</span> ctreeFit,</span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">C45 =</span> C45Fit,</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">SVM =</span> svmFit,</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">KNN =</span> knnFit,</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">rules =</span> rulesFit,</span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">randomForest =</span> randomForestFit,</span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">xgboost =</span> xgboostFit,</span>
<span id="cb132-9"><a href="#cb132-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">NeuralNet =</span> nnetFit</span>
<span id="cb132-10"><a href="#cb132-10" aria-hidden="true" tabindex="-1"></a>    ))</span>
<span id="cb132-11"><a href="#cb132-11" aria-hidden="true" tabindex="-1"></a>resamps</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
resamples.default(x = list(ctree = ctreeFit, C45 = C45Fit, SVM = svmFit, KNN
 = knnFit, rules = rulesFit, randomForest = randomForestFit, xgboost
 = xgboostFit, NeuralNet = nnetFit))

Models: ctree, C45, SVM, KNN, rules, randomForest, xgboost, NeuralNet 
Number of resamples: 10 
Performance metrics: Accuracy, Kappa 
Time estimates for: everything, final model fit </code></pre>
</div>
</div>
<p>These models were evaluated using 10 resamples and assessed based on performance metrics such as Accuracy and Kappa. The process also estimated the time required for various tasks, including model fitting and overall execution.</p>
<p>Calculating summary statistics</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(resamps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
summary.resamples(object = resamps)

Models: ctree, C45, SVM, KNN, rules, randomForest, xgboost, NeuralNet 
Number of resamples: 10 

Accuracy 
              Min. 1st Qu. Median  Mean 3rd Qu.  Max. NA's
ctree        0.867   0.878  0.887 0.888   0.897 0.910    0
C45          0.875   0.876  0.893 0.891   0.900 0.918    0
SVM          0.812   0.834  0.844 0.845   0.862 0.867    0
KNN          0.948   0.954  0.963 0.963   0.969 0.978    0
rules        0.867   0.876  0.883 0.886   0.891 0.924    0
randomForest 0.954   0.959  0.959 0.964   0.967 0.976    0
xgboost      0.821   0.861  0.871 0.869   0.882 0.902    0
NeuralNet    0.856   0.868  0.881 0.879   0.885 0.905    0

Kappa 
              Min. 1st Qu. Median  Mean 3rd Qu.  Max. NA's
ctree        0.710   0.734  0.757 0.758   0.780 0.806    0
C45          0.726   0.732  0.767 0.765   0.783 0.825    0
SVM          0.590   0.635  0.661 0.663   0.698 0.712    0
KNN          0.890   0.902  0.922 0.921   0.936 0.954    0
rules        0.718   0.734  0.747 0.756   0.762 0.838    0
randomForest 0.902   0.914  0.914 0.923   0.931 0.949    0
xgboost      0.605   0.702  0.719 0.716   0.747 0.791    0
NeuralNet    0.688   0.715  0.745 0.740   0.752 0.798    0</code></pre>
</div>
</div>
<p>The summary provides a comparison of multiple machine learning models using accuracy and Kappa metrics. Each model’s performance is summarized with statistics, revealing that randomForest achieved the highest accuracy and Kappa, while ctree and C45 also performed well. The summary aids in model selection for classification tasks.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(resamps, <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This plot provides insights into the variability of model performance across different algorithms and can help in model selection and comparison.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>difs <span class="ot">&lt;-</span> <span class="fu">diff</span>(resamps)</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>difs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
diff.resamples(x = resamps)

Models: ctree, C45, SVM, KNN, rules, randomForest, xgboost, NeuralNet 
Metrics: Accuracy, Kappa 
Number of differences: 28 
p-value adjustment: bonferroni </code></pre>
</div>
</div>
<p>The output is the result of comparing resampling results across various machine learning models (models) and performance metrics (metrics) for differences using the “diff.resamples” function. It identifies a total of 28 differences and uses Bonferroni correction for p-value adjustment, indicating variations in model performance across the specified models and metrics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(difs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
summary.diff.resamples(object = difs)

p-value adjustment: bonferroni 
Upper diagonal: estimates of the difference
Lower diagonal: p-value for H0: difference = 0

Accuracy 
             ctree    C45      SVM      KNN      rules    randomForest xgboost 
ctree                 -0.00326  0.04264 -0.07470  0.00136 -0.07578      0.01901
C45          1.000000           0.04590 -0.07143  0.00462 -0.07252      0.02227
SVM          0.000207 1.33e-05          -0.11734 -0.04129 -0.11842     -0.02364
KNN          1.93e-06 1.74e-06 5.95e-08           0.07605 -0.00108      0.09370
rules        1.000000 1.000000 7.80e-05 1.33e-06          -0.07713      0.01765
randomForest 3.31e-07 7.79e-07 1.14e-07 1.000000 1.48e-06               0.09478
xgboost      0.157373 0.041002 0.205514 1.89e-05 0.766137 8.18e-06             
NeuralNet    0.614197 0.059445 0.001782 8.27e-07 1.000000 1.96e-07     1.000000
             NeuralNet
ctree         0.00896 
C45           0.01222 
SVM          -0.03368 
KNN           0.08366 
rules         0.00761 
randomForest  0.08474 
xgboost      -0.01004 
NeuralNet             

Kappa 
             ctree    C45      SVM      KNN      rules    randomForest xgboost 
ctree                 -0.00649  0.09557 -0.16262  0.00200 -0.16496      0.04204
C45          1.000000           0.10205 -0.15613  0.00848 -0.15847      0.04852
SVM          0.000191 1.19e-05          -0.25819 -0.09357 -0.26053     -0.05353
KNN          2.43e-06 1.71e-06 5.84e-08           0.16462 -0.00234      0.20466
rules        1.000000 1.000000 7.61e-05 1.07e-06          -0.16696      0.04004
randomForest 4.28e-07 7.99e-07 1.18e-07 1.000000 9.94e-07               0.20700
xgboost      0.224991 0.080016 0.220869 2.73e-05 0.763800 1.20e-05             
NeuralNet    1.000000 0.092422 0.001097 9.08e-07 1.000000 2.14e-07     1.000000
             NeuralNet
ctree         0.01792 
C45           0.02440 
SVM          -0.07765 
KNN           0.18054 
rules         0.01592 
randomForest  0.18288 
xgboost      -0.02412 
NeuralNet             </code></pre>
</div>
</div>
<p>The output summarizes the statistical differences (difs) in model performance (Accuracy and Kappa) among various machine learning models. It provides the estimated differences and p-values for pairwise model comparisons. Statistically significant differences are observed, indicating variations in performance between models. Bonferroni correction is applied to control for multiple comparisons.</p>
</section>
<section id="applying-the-chosen-model-to-the-test-data" class="level2">
<h2 class="anchored" data-anchor-id="applying-the-chosen-model-to-the-test-data"><strong>Applying the Chosen Model to the Test Data</strong></h2>
<p>From the above summary, random forest would be a good choice if we consider both accuracy and Kappa metrics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>pr <span class="ot">&lt;-</span> <span class="fu">predict</span>(randomForestFit, spam_test)</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>pr</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] n n y y y n y y y y y y y y y n y y y y n y y y y n y y y y n y y n y y n
 [38] y y y n y y y y y n y y y y y y y n y y y y y y y n y y n y y y y y y y n
 [75] y y y y y n y y y y y y y y y y n n y y y n n y y y y y y n n y y y y n y
[112] y y n y n n y y y y n n y n n y y y y y y y y y y y n y y y y y y y y n y
[149] y y y y y y n y y y y y y y y y y y n n y y y y y y y y n y y y y n y y y
[186] y y y y y y y y y y y y y y y y y y y y y y y y y y y y y y n y y n y y y
[223] y y y y n y y y y y y y y n y n y n n y y y y y n y n y y y y y y y y y y
[260] y y y y n y y n y y y y y y y y y y n n y y n y n n y y n y y y y y n y n
[297] y y n y n y y n y y y n y n y y y y y n y n y n y y n y y y y n y y n y y
[334] y n y y y n n y y y y y n y y y y y n y y y y y y n n y y n n n n n n n n
[371] n n n n n n n n n n n n n n n n n n y n y y n n n n n n y y n n y n n n n
[408] n n n n n n n y y n n n n n n n n n n n n n n n n n n n n n n n y n n n n
[445] n n n n n n n n n n n n n y n n n n n n n n n n y n y n n n n y n n n y n
[482] n n n n n n y n y n n n n n n n n n n n n n n y n n n n n n n n n n n y n
[519] n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n
[556] n n n n n n n n n n n n n n n n n n n n n y n n n n n n n n n n n n n n n
[593] n n n n n n n y n n n n n n n n n n n n n n n n n n y n y n n n n n n n n
[630] n n n n n n n n n n n n n n n n n n n n n n n n n n n n n y n n n n n n n
[667] n n n n n n n n n n n n n y n n y n n n n n n n n n n n n n y n y n n n n
[704] n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n
[741] n n n n y n n n n n n n y n n n n n n n n n n n n n n n n n n n n n n n n
[778] n n n n n n n n n n n n n n n n n n n n n y n n n n n n n n n n n n n n n
[815] n n n n n n n y n n n n n n n y n n n n n n n n y n n n n n n n n n n n n
[852] n n n n n y y n n n n n n n n n n y n n n n n n n n y n n y n n n n n n y
[889] n n n n n n n n y y n n n n y n n n n n n n n n n n n n n n n
Levels: n y</code></pre>
</div>
</div>
<p>Calculate the confusion matrix for the held-out test data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(pr, <span class="at">reference =</span> spam_test<span class="sc">$</span>yesno)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   n   y
         n 515  74
         y  42 288
                                        
               Accuracy : 0.874         
                 95% CI : (0.851, 0.895)
    No Information Rate : 0.606         
    P-Value [Acc &gt; NIR] : &lt;2e-16        
                                        
                  Kappa : 0.731         
                                        
 Mcnemar's Test P-Value : 0.004         
                                        
            Sensitivity : 0.925         
            Specificity : 0.796         
         Pos Pred Value : 0.874         
         Neg Pred Value : 0.873         
             Prevalence : 0.606         
         Detection Rate : 0.560         
   Detection Prevalence : 0.641         
      Balanced Accuracy : 0.860         
                                        
       'Positive' Class : n             
                                        </code></pre>
</div>
</div>
<p>The confusion matrix shows the classification performance of a model. In this case, the model correctly predicted 515 instances of class ‘n’ and 288 instances of class ‘y’, while making 74 false negative predictions and 42 false positive predictions. The model has an accuracy of 87.4%, indicating its overall correctness. The Kappa statistic measures the model’s performance, with a value of 0.731 suggesting substantial agreement. Sensitivity and specificity show the model’s ability to detect true positives and true negatives, and the balanced accuracy is 86%. The McNemar’s Test p-value of 0.004 indicates a significant difference between the model’s predictions and random chance.</p>
</section>
<section id="comparing-decision-boundaries-of-popular-classification-techniques" class="level2">
<h2 class="anchored" data-anchor-id="comparing-decision-boundaries-of-popular-classification-techniques"><strong>Comparing Decision Boundaries of Popular Classification Techniques</strong></h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb145-6"><a href="#cb145-6" aria-hidden="true" tabindex="-1"></a>decisionplot <span class="ot">&lt;-</span> <span class="cf">function</span>(model, data, class_var, </span>
<span id="cb145-7"><a href="#cb145-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">predict_type =</span> <span class="fu">c</span>(<span class="st">"class"</span>, <span class="st">"prob"</span>), <span class="at">resolution =</span> <span class="dv">3</span> <span class="sc">*</span> <span class="dv">72</span>) {</span>
<span id="cb145-8"><a href="#cb145-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># resolution is set to 72 dpi if the image is rendered  3 inches wide. </span></span>
<span id="cb145-9"><a href="#cb145-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-10"><a href="#cb145-10" aria-hidden="true" tabindex="-1"></a>  y <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> <span class="fu">pull</span>(class_var)</span>
<span id="cb145-11"><a href="#cb145-11" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span><span class="fu">all_of</span>(class_var))</span>
<span id="cb145-12"><a href="#cb145-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-13"><a href="#cb145-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># resubstitution accuracy</span></span>
<span id="cb145-14"><a href="#cb145-14" aria-hidden="true" tabindex="-1"></a>  prediction <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, x, <span class="at">type =</span> predict_type[<span class="dv">1</span>])</span>
<span id="cb145-15"><a href="#cb145-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># LDA returns a list</span></span>
<span id="cb145-16"><a href="#cb145-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.list</span>(prediction)) prediction <span class="ot">&lt;-</span> prediction<span class="sc">$</span>class</span>
<span id="cb145-17"><a href="#cb145-17" aria-hidden="true" tabindex="-1"></a>  prediction <span class="ot">&lt;-</span> <span class="fu">factor</span>(prediction, <span class="at">levels =</span> <span class="fu">levels</span>(y))</span>
<span id="cb145-18"><a href="#cb145-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-19"><a href="#cb145-19" aria-hidden="true" tabindex="-1"></a>  cm <span class="ot">&lt;-</span> <span class="fu">confusionMatrix</span>(<span class="at">data =</span> prediction, </span>
<span id="cb145-20"><a href="#cb145-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">reference =</span> y)</span>
<span id="cb145-21"><a href="#cb145-21" aria-hidden="true" tabindex="-1"></a>  acc <span class="ot">&lt;-</span> cm<span class="sc">$</span>overall[<span class="st">"Accuracy"</span>]</span>
<span id="cb145-22"><a href="#cb145-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-23"><a href="#cb145-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># evaluate model on a grid</span></span>
<span id="cb145-24"><a href="#cb145-24" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x[, <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], range, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb145-25"><a href="#cb145-25" aria-hidden="true" tabindex="-1"></a>  xs <span class="ot">&lt;-</span> <span class="fu">seq</span>(r[<span class="dv">1</span>,<span class="dv">1</span>], r[<span class="dv">2</span>,<span class="dv">1</span>], <span class="at">length.out =</span> resolution)</span>
<span id="cb145-26"><a href="#cb145-26" aria-hidden="true" tabindex="-1"></a>  ys <span class="ot">&lt;-</span> <span class="fu">seq</span>(r[<span class="dv">1</span>,<span class="dv">2</span>], r[<span class="dv">2</span>,<span class="dv">2</span>], <span class="at">length.out =</span> resolution)</span>
<span id="cb145-27"><a href="#cb145-27" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">rep</span>(xs, <span class="at">each =</span> resolution), <span class="fu">rep</span>(ys, <span class="at">time =</span> resolution))</span>
<span id="cb145-28"><a href="#cb145-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">colnames</span>(g) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(r)</span>
<span id="cb145-29"><a href="#cb145-29" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(g)</span>
<span id="cb145-30"><a href="#cb145-30" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-31"><a href="#cb145-31" aria-hidden="true" tabindex="-1"></a>  <span class="do">### guess how to get class labels from predict</span></span>
<span id="cb145-32"><a href="#cb145-32" aria-hidden="true" tabindex="-1"></a>  <span class="do">### (unfortunately not very consistent between models)</span></span>
<span id="cb145-33"><a href="#cb145-33" aria-hidden="true" tabindex="-1"></a>  cl <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, g, <span class="at">type =</span> predict_type[<span class="dv">1</span>])</span>
<span id="cb145-34"><a href="#cb145-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-35"><a href="#cb145-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># LDA returns a list</span></span>
<span id="cb145-36"><a href="#cb145-36" aria-hidden="true" tabindex="-1"></a>  prob <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb145-37"><a href="#cb145-37" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">is.list</span>(cl)) { </span>
<span id="cb145-38"><a href="#cb145-38" aria-hidden="true" tabindex="-1"></a>    prob <span class="ot">&lt;-</span> cl<span class="sc">$</span>posterior</span>
<span id="cb145-39"><a href="#cb145-39" aria-hidden="true" tabindex="-1"></a>    cl <span class="ot">&lt;-</span> cl<span class="sc">$</span>class</span>
<span id="cb145-40"><a href="#cb145-40" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span></span>
<span id="cb145-41"><a href="#cb145-41" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.na</span>(predict_type[<span class="dv">2</span>]))</span>
<span id="cb145-42"><a href="#cb145-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">try</span>(prob <span class="ot">&lt;-</span> <span class="fu">predict</span>(model, g, <span class="at">type =</span> predict_type[<span class="dv">2</span>]))</span>
<span id="cb145-43"><a href="#cb145-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-44"><a href="#cb145-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># we visualize the difference in probability/score between the </span></span>
<span id="cb145-45"><a href="#cb145-45" aria-hidden="true" tabindex="-1"></a>  <span class="co"># winning class and the second best class.</span></span>
<span id="cb145-46"><a href="#cb145-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># don't use probability if predict for the classifier does not support it.</span></span>
<span id="cb145-47"><a href="#cb145-47" aria-hidden="true" tabindex="-1"></a>  max_prob <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb145-48"><a href="#cb145-48" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(prob))</span>
<span id="cb145-49"><a href="#cb145-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">try</span>({</span>
<span id="cb145-50"><a href="#cb145-50" aria-hidden="true" tabindex="-1"></a>      max_prob <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(prob, <span class="at">MARGIN =</span> <span class="dv">1</span>, sort, <span class="at">decreasing =</span> <span class="cn">TRUE</span>))</span>
<span id="cb145-51"><a href="#cb145-51" aria-hidden="true" tabindex="-1"></a>      max_prob <span class="ot">&lt;-</span> max_prob[,<span class="dv">1</span>] <span class="sc">-</span> max_prob[,<span class="dv">2</span>]</span>
<span id="cb145-52"><a href="#cb145-52" aria-hidden="true" tabindex="-1"></a>    }, <span class="at">silent =</span> <span class="cn">TRUE</span>) </span>
<span id="cb145-53"><a href="#cb145-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-54"><a href="#cb145-54" aria-hidden="true" tabindex="-1"></a>  cl <span class="ot">&lt;-</span> <span class="fu">factor</span>(cl, <span class="at">levels =</span> <span class="fu">levels</span>(y))</span>
<span id="cb145-55"><a href="#cb145-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-56"><a href="#cb145-56" aria-hidden="true" tabindex="-1"></a>  g <span class="ot">&lt;-</span> g <span class="sc">|&gt;</span> <span class="fu">add_column</span>(<span class="at">prediction =</span> cl, <span class="at">probability =</span> max_prob)</span>
<span id="cb145-57"><a href="#cb145-57" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb145-58"><a href="#cb145-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(g, <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="cb145-59"><a href="#cb145-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> .data[[<span class="fu">colnames</span>(g)[<span class="dv">1</span>]]], <span class="at">y =</span> .data[[<span class="fu">colnames</span>(g)[<span class="dv">2</span>]]])) <span class="sc">+</span></span>
<span id="cb145-60"><a href="#cb145-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_raster</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">fill =</span> prediction, <span class="at">alpha =</span> probability)) <span class="sc">+</span></span>
<span id="cb145-61"><a href="#cb145-61" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_contour</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">z =</span> <span class="fu">as.numeric</span>(prediction)), </span>
<span id="cb145-62"><a href="#cb145-62" aria-hidden="true" tabindex="-1"></a>      <span class="at">bins =</span> <span class="fu">length</span>(<span class="fu">levels</span>(cl)), <span class="at">linewidth =</span> .<span class="dv">5</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb145-63"><a href="#cb145-63" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_point</span>(<span class="at">data =</span> data, <span class="at">mapping =</span>  <span class="fu">aes</span>(</span>
<span id="cb145-64"><a href="#cb145-64" aria-hidden="true" tabindex="-1"></a>      <span class="at">x =</span> .data[[<span class="fu">colnames</span>(data)[<span class="dv">1</span>]]], </span>
<span id="cb145-65"><a href="#cb145-65" aria-hidden="true" tabindex="-1"></a>      <span class="at">y =</span> .data[[<span class="fu">colnames</span>(data)[<span class="dv">2</span>]]],</span>
<span id="cb145-66"><a href="#cb145-66" aria-hidden="true" tabindex="-1"></a>      <span class="at">shape =</span> .data[[class_var]]), <span class="at">alpha =</span> .<span class="dv">7</span>) <span class="sc">+</span> </span>
<span id="cb145-67"><a href="#cb145-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_alpha_continuous</span>(<span class="at">range =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">guide =</span> <span class="st">"none"</span>) <span class="sc">+</span>  </span>
<span id="cb145-68"><a href="#cb145-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Training accuracy:"</span>, <span class="fu">round</span>(acc, <span class="dv">2</span>))) <span class="sc">+</span></span>
<span id="cb145-69"><a href="#cb145-69" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>)</span>
<span id="cb145-70"><a href="#cb145-70" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Preprocessing</span></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># Set a seed for reproducibility</span></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(spam) <span class="sc">%&gt;%</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sample_n</span>(<span class="dv">150</span>)  <span class="co"># Sample 150 points</span></span>
<span id="cb146-8"><a href="#cb146-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-9"><a href="#cb146-9" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> x <span class="sc">%&gt;%</span></span>
<span id="cb146-10"><a href="#cb146-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(dollar, bang, yesno) <span class="sc">%&gt;%</span></span>
<span id="cb146-11"><a href="#cb146-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">money =</span> <span class="fu">scale</span>(dollar), <span class="at">dollar =</span> <span class="fu">scale</span>(bang))</span>
<span id="cb146-12"><a href="#cb146-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-13"><a href="#cb146-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb146-14"><a href="#cb146-14" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb146-15"><a href="#cb146-15" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb146-16"><a href="#cb146-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">dollar =</span> <span class="fu">replicate</span>(n, <span class="fu">rnorm</span>(<span class="dv">1</span>)),</span>
<span id="cb146-17"><a href="#cb146-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">bang =</span> <span class="fu">replicate</span>(n, <span class="fu">rnorm</span>(<span class="dv">1</span>)),</span>
<span id="cb146-18"><a href="#cb146-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">yesno =</span> <span class="fu">factor</span>(<span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"y"</span>, <span class="st">"n"</span>), n, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb146-19"><a href="#cb146-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb146-20"><a href="#cb146-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-21"><a href="#cb146-21" aria-hidden="true" tabindex="-1"></a><span class="co">#The above code is done so that the bang and dollar values are scaled and are in the xy plane which makes the classification much more easier for the classifiers and also comprehensible for viewers. The scatterplot of bang and dollar values are not in the xy plane and most of the values are along the x and y axes, thus the above code is the only way to visualize the classification done by the classifier for this dataset.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="co"># visualizing the datapoints after scaling the bang and dollar values</span></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x, <span class="fu">aes</span>(<span class="at">x =</span> dollar, <span class="at">y =</span> bang, <span class="at">fill =</span> yesno)) <span class="sc">+</span>  </span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_density_2d</span>(<span class="at">geom =</span> <span class="st">"polygon"</span>, <span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fu">after_stat</span>(level))) <span class="sc">+</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>(<span class="at">base_size =</span> <span class="dv">14</span>) <span class="sc">+</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"dollar"</span>,</span>
<span id="cb147-8"><a href="#cb147-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"bang"</span>,</span>
<span id="cb147-9"><a href="#cb147-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb147-10"><a href="#cb147-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">alpha =</span> <span class="st">"Density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-83-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above plot is the scatter plot of dollar vs bang features. They are classified into yes or no and the intensity denotes the concentration of data.</p>
<section id="k-nearest-neighbors-classifier" class="level4">
<h4 class="anchored" data-anchor-id="k-nearest-neighbors-classifier">K-Nearest Neighbors Classifier</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> caret<span class="sc">::</span><span class="fu">knn3</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _, <span class="at">k =</span> <span class="dv">1</span>)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>) <span class="sc">+</span> </span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"kNN (1 neighbor)"</span>,</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"dollar"</span>,</span>
<span id="cb148-5"><a href="#cb148-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"bang"</span>,</span>
<span id="cb148-6"><a href="#cb148-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb148-7"><a href="#cb148-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-84-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># This code builds a k-Nearest Neighbors (kNN) classification model with one neighbor and visualizes its decision boundaries based on the 'dollar' and 'bang' features, showing how it predicts the 'yesno' class.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above plot is the kNN model with 1 neighbor. We can say that the model is overfitting which can be explained by the high accuracy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 3 Neighbours</span></span>
<span id="cb150-2"><a href="#cb150-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb150-3"><a href="#cb150-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> caret<span class="sc">::</span><span class="fu">knn3</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb150-4"><a href="#cb150-4" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>) <span class="sc">+</span> </span>
<span id="cb150-5"><a href="#cb150-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"kNN (3 neighbor)"</span>,</span>
<span id="cb150-6"><a href="#cb150-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"dollar"</span>,</span>
<span id="cb150-7"><a href="#cb150-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"bang"</span>,</span>
<span id="cb150-8"><a href="#cb150-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb150-9"><a href="#cb150-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-85-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above plot is the kNN model using k as 3, the decision boundaries are still sharp but not as sharp as when k was 1. The accuracy also got hit and got reduced to 77</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 9 Neighbours</span></span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> caret<span class="sc">::</span><span class="fu">knn3</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _, <span class="at">k =</span> <span class="dv">9</span>)</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>) <span class="sc">+</span> </span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"kNN (9 neighbor)"</span>,</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"dollar"</span>,</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"bang"</span>,</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-86-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above graph is the kNN model with 9 neighbors. The boundaries are smoother when compared to the previous models and accuracy also got reduced accordingly.</p>
</section>
<section id="naive-bayes-classifier" class="level4">
<h4 class="anchored" data-anchor-id="naive-bayes-classifier">Naive Bayes Classifier</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> e1071<span class="sc">::</span><span class="fu">naiveBayes</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _)</span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>, </span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">predict_type =</span> <span class="fu">c</span>(<span class="st">"class"</span>, <span class="st">"raw"</span>)) <span class="sc">+</span> </span>
<span id="cb152-4"><a href="#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"naive Bayes"</span>,</span>
<span id="cb152-5"><a href="#cb152-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb152-6"><a href="#cb152-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This code builds a naive bayes classifier and prints the model using decisionplot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above plot depicts the Naive Bayes model (probablistic) classfication of dollar and bang features. The boundaries are smooth and accuracy is 64</p>
</section>
<section id="linear-discriminant-analysis" class="level4">
<h4 class="anchored" data-anchor-id="linear-discriminant-analysis">Linear Discriminant Analysis</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> MASS<span class="sc">::</span><span class="fu">lda</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>) <span class="sc">+</span> </span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"LDA"</span>,</span>
<span id="cb154-4"><a href="#cb154-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb154-5"><a href="#cb154-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This code builds a LDA classifier and prints the model using decisionplot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above LDA model shows a linear separation, as it is a linear classifier.</p>
</section>
<section id="logistic-regression-implemented-in-nnet" class="level4">
<h4 class="anchored" data-anchor-id="logistic-regression-implemented-in-nnet">Logistic Regression (implemented in nnet)</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> spam <span class="sc">|&gt;</span> nnet<span class="sc">::</span><span class="fu">multinom</span>(yesno <span class="sc">~</span>dollar<span class="sc">+</span>bang, <span class="at">data =</span> _)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  4 (3 variable)
initial  value 3189.170178 
iter  10 value 2493.702586
iter  20 value 2413.668661
iter  30 value 2407.601388
final  value 2407.375351 
converged</code></pre>
</div>
</div>
<p>This log likely represents an optimization process with four weights, where the initial value was 3189.17. After 30 iterations, it converged to a final value of 2407.38, indicating successful minimization of the objective function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>) <span class="sc">+</span> </span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Multinomial Logistic Regression"</span>,</span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"dollar"</span>,</span>
<span id="cb158-4"><a href="#cb158-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"bang"</span>,</span>
<span id="cb158-5"><a href="#cb158-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb158-6"><a href="#cb158-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This and the previous code builds a Logistic regression classifier and prints the model using decisionplot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above Multinomial logistic regression plot shows the classification of dollar and bang feature value along the bang-dollar space. The shapes are the actual datapoints and colors represents the prediction.</p>
</section>
<section id="decision-trees-1" class="level4">
<h4 class="anchored" data-anchor-id="decision-trees-1">Decision Trees</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> spam <span class="sc">|&gt;</span> rpart<span class="sc">::</span><span class="fu">rpart</span>(yesno <span class="sc">~</span> dollar<span class="sc">+</span>bang, <span class="at">data =</span> _)</span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>) <span class="sc">+</span> </span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"CART"</span>,</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"dollar"</span>,</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"bang"</span>,</span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This code builds a Decision trees and prints the model using decisionplot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above decision tree plot showcases the decision boundaries created by the CART model. It classifies the features in the feature space (by space)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb162"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> rpart<span class="sc">::</span><span class="fu">rpart</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _,</span>
<span id="cb162-2"><a href="#cb162-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">cp =</span> <span class="fl">0.001</span>, <span class="at">minsplit =</span> <span class="dv">1</span>))</span>
<span id="cb162-3"><a href="#cb162-3" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>) <span class="sc">+</span> </span>
<span id="cb162-4"><a href="#cb162-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"CART (overfitting)"</span>,</span>
<span id="cb162-5"><a href="#cb162-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"dollar"</span>,</span>
<span id="cb162-6"><a href="#cb162-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"bang"</span>,</span>
<span id="cb162-7"><a href="#cb162-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb162-8"><a href="#cb162-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above decision tree’s boundaries are slightly more complex than the standard CART model. The accuracy is also 1 which could indicate overfitting</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> C50<span class="sc">::</span><span class="fu">C5.0</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>) <span class="sc">+</span> </span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"C5.0"</span>,</span>
<span id="cb163-4"><a href="#cb163-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"dollar"</span>,</span>
<span id="cb163-5"><a href="#cb163-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"bang"</span>,</span>
<span id="cb163-6"><a href="#cb163-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb163-7"><a href="#cb163-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Computation failed in `stat_contour()`
Caused by error in `if (zero_range(range)) ...`:
! missing value where TRUE/FALSE needed</code></pre>
</div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above is the classification done using C5.0 model.</p>
</section>
<section id="random-forest-1" class="level4">
<h4 class="anchored" data-anchor-id="random-forest-1">Random Forest</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> randomForest<span class="sc">::</span><span class="fu">randomForest</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _)</span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>) <span class="sc">+</span> </span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Random Forest"</span>,</span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"dollar"</span>,</span>
<span id="cb165-5"><a href="#cb165-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"bang"</span>,</span>
<span id="cb165-6"><a href="#cb165-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb165-7"><a href="#cb165-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This code builds a random forest model and prints the model using decisionplot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The classifier’s decision boundaries show the numerous decision of multiple decision trees.</p>
</section>
<section id="svm" class="level4">
<h4 class="anchored" data-anchor-id="svm">SVM</h4>
<section id="linear-kernel" class="level5">
<h5 class="anchored" data-anchor-id="linear-kernel">Linear kernel</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> e1071<span class="sc">::</span><span class="fu">svm</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _, <span class="at">kernel =</span> <span class="st">"linear"</span>)</span>
<span id="cb167-2"><a href="#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>) <span class="sc">+</span> </span>
<span id="cb167-3"><a href="#cb167-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SVM (linear kernel)"</span>,</span>
<span id="cb167-4"><a href="#cb167-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb167-5"><a href="#cb167-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This code builds a svm model and prints the model using decisionplot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>As the above kernel is linear, the separation is linear amongst the features.</p>
</section>
</section>
<section id="radial-kernel" class="level4">
<h4 class="anchored" data-anchor-id="radial-kernel">Radial Kernel</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> e1071<span class="sc">::</span><span class="fu">svm</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _, <span class="at">kernel =</span> <span class="st">"radial"</span>)</span>
<span id="cb169-2"><a href="#cb169-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>) <span class="sc">+</span> </span>
<span id="cb169-3"><a href="#cb169-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SVM (radial kernel)"</span>,</span>
<span id="cb169-4"><a href="#cb169-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb169-5"><a href="#cb169-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-96-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above depitcs the decision boundaries for the radial SVM. From thr plot we can see that it created flexible boundaries compared to the linear SVM.</p>
</section>
<section id="polynomial-kernel" class="level4">
<h4 class="anchored" data-anchor-id="polynomial-kernel">Polynomial kernel</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> e1071<span class="sc">::</span><span class="fu">svm</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _, <span class="at">kernel =</span> <span class="st">"polynomial"</span>)</span>
<span id="cb170-2"><a href="#cb170-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>) <span class="sc">+</span> </span>
<span id="cb170-3"><a href="#cb170-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SVM (polynomial kernel)"</span>,</span>
<span id="cb170-4"><a href="#cb170-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb170-5"><a href="#cb170-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-97-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above plot depicts the decision boundaries for the polynomial SVM. As they are polynomial, it is curved.</p>
</section>
<section id="sigmoid-kernel" class="level4">
<h4 class="anchored" data-anchor-id="sigmoid-kernel">Sigmoid kernel</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> e1071<span class="sc">::</span><span class="fu">svm</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _, <span class="at">kernel =</span> <span class="st">"sigmoid"</span>)</span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>) <span class="sc">+</span> </span>
<span id="cb171-3"><a href="#cb171-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"SVM (sigmoid kernel)"</span>,</span>
<span id="cb171-4"><a href="#cb171-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb171-5"><a href="#cb171-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above plot depicts the decision boundaries for the sigmoid SVM. The sigmoid kernel also produces flexible boundaries but they are more along the dollar axis.</p>
</section>
<section id="single-layer-feed-forward-neural-networks" class="level4">
<h4 class="anchored" data-anchor-id="single-layer-feed-forward-neural-networks">Single Layer Feed-forward Neural Networks</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> x <span class="sc">|&gt;</span> nnet<span class="sc">::</span><span class="fu">nnet</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb172-2"><a href="#cb172-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>, </span>
<span id="cb172-3"><a href="#cb172-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">predict_type =</span> <span class="st">"class"</span>) <span class="sc">+</span> </span>
<span id="cb172-4"><a href="#cb172-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"NN (1 neuron)"</span>,</span>
<span id="cb172-5"><a href="#cb172-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb172-6"><a href="#cb172-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This code builds a single layer fee-forward neural networks and prints the model using decisionplot()</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The above neural network with 1 neuron has created a decision boundary similar to a linear classifier to classify the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb174"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span>x <span class="sc">|&gt;</span> nnet<span class="sc">::</span><span class="fu">nnet</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _, <span class="at">size =</span> <span class="dv">2</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb174-2"><a href="#cb174-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>, </span>
<span id="cb174-3"><a href="#cb174-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">predict_type =</span> <span class="fu">c</span>(<span class="st">"class"</span>)) <span class="sc">+</span> </span>
<span id="cb174-4"><a href="#cb174-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"NN (2 neurons)"</span>,</span>
<span id="cb174-5"><a href="#cb174-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb174-6"><a href="#cb174-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above boundaries are basically construted by 2 neuron and they are classify using multiple-line like boundaries.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span>x <span class="sc">|&gt;</span> nnet<span class="sc">::</span><span class="fu">nnet</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>, </span>
<span id="cb175-3"><a href="#cb175-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">predict_type =</span> <span class="fu">c</span>(<span class="st">"class"</span>)) <span class="sc">+</span> </span>
<span id="cb175-4"><a href="#cb175-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"NN (4 neurons)"</span>,</span>
<span id="cb175-5"><a href="#cb175-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb175-6"><a href="#cb175-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above plot depicts the boundaries with 4 neurons, the decision boundary appears more complex . This is better than the previous versions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb176"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb176-1"><a href="#cb176-1" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span>x <span class="sc">|&gt;</span> nnet<span class="sc">::</span><span class="fu">nnet</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">trace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb176-2"><a href="#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">decisionplot</span>(model, x, <span class="at">class_var =</span> <span class="st">"yesno"</span>, </span>
<span id="cb176-3"><a href="#cb176-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">predict_type =</span> <span class="fu">c</span>(<span class="st">"class"</span>)) <span class="sc">+</span> </span>
<span id="cb176-4"><a href="#cb176-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"NN (10 neurons)"</span>,</span>
<span id="cb176-5"><a href="#cb176-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">"Yes/No"</span>,</span>
<span id="cb176-6"><a href="#cb176-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">"Prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hm3-Kevin-Diesel_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The above plot depicts the neural network with 10 neurons. The boundaries are highly flexible. They are fitting the data very well. This can also mean they could be overfitting. But the accuracy is pretty decent at 80.</p>
</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>